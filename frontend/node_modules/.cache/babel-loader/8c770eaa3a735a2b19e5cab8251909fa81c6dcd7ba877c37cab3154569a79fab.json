{"ast":null,"code":"var _jsxFileName = \"/Users/gustsantos/Desktop/initucastt/frontend/src/pages/JourneyBuilder.jsx\",\n  _s = $RefreshSig$();\n// frontend/src/pages/JourneyBuilder.jsx\nimport React, { useEffect, useMemo, useState } from 'react';\nimport ReactFlow, { Background, Controls, MiniMap, addEdge, useEdgesState, useNodesState, Handle, Position } from 'reactflow';\nimport 'reactflow/dist/style.css';\n\n// ---------- NODES (com Handle real e pinos coloridos) ----------\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Pin = ({\n  type,\n  position,\n  color = '#64748b',\n  id\n}) => /*#__PURE__*/_jsxDEV(Handle, {\n  type: type,\n  position: position,\n  id: id,\n  style: {\n    width: 14,\n    height: 14,\n    background: '#fff',\n    border: `2px solid ${color}`,\n    boxShadow: '0 0 0 2px #eef2ff inset'\n  }\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 17,\n  columnNumber: 3\n}, this);\n_c = Pin;\nconst Shell = ({\n  title,\n  subtitle,\n  selected,\n  children\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    minWidth: 240,\n    background: '#fff',\n    border: selected ? '2px solid #2563eb' : '1px solid #e5e7eb',\n    borderRadius: 12,\n    padding: '12px 14px',\n    boxShadow: '0 2px 8px rgba(0,0,0,0.05)'\n  },\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontWeight: 700,\n      marginBottom: 6\n    },\n    children: title\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this), subtitle ? /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: subtitle\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 17\n  }, this) : null, children]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 32,\n  columnNumber: 3\n}, this);\n_c2 = Shell;\nconst StartNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: \"Start\",\n  subtitle: \"in\\xEDcio do fluxo\",\n  selected: selected,\n  children: /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"source\",\n    position: Position.Right,\n    color: \"#16a34a\",\n    id: \"out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 49,\n  columnNumber: 3\n}, this);\n_c3 = StartNode;\nconst EndNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: \"End\",\n  subtitle: \"t\\xE9rmino do fluxo\",\n  selected: selected,\n  children: /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"target\",\n    position: Position.Left,\n    color: \"#ef4444\",\n    id: \"in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 55,\n  columnNumber: 3\n}, this);\n_c4 = EndNode;\nconst MessageNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: (data === null || data === void 0 ? void 0 : data.label) || 'Message',\n  subtitle: `Template: ${(data === null || data === void 0 ? void 0 : data.templateName) || '—'}`,\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(Pin, {\n    type: \"target\",\n    position: Position.Left,\n    color: \"#64748b\",\n    id: \"in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"source\",\n    position: Position.Right,\n    color: \"#16a34a\",\n    id: \"out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 61,\n  columnNumber: 3\n}, this);\n_c5 = MessageNode;\nconst ApiNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: (data === null || data === void 0 ? void 0 : data.label) || 'API Call',\n  subtitle: `${((data === null || data === void 0 ? void 0 : data.method) || 'GET').toUpperCase()}`,\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(Pin, {\n    type: \"target\",\n    position: Position.Left,\n    color: \"#64748b\",\n    id: \"in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"source\",\n    position: Position.Right,\n    color: \"#16a34a\",\n    id: \"out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 72,\n  columnNumber: 3\n}, this);\n_c6 = ApiNode;\nconst CodeNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: (data === null || data === void 0 ? void 0 : data.label) || 'Code',\n  subtitle: \"JavaScript step\",\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(Pin, {\n    type: \"target\",\n    position: Position.Left,\n    color: \"#64748b\",\n    id: \"in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"source\",\n    position: Position.Right,\n    color: \"#16a34a\",\n    id: \"out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 83,\n  columnNumber: 3\n}, this);\n_c7 = CodeNode;\nconst FreeFormNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Shell, {\n  title: (data === null || data === void 0 ? void 0 : data.label) || 'Free Form',\n  subtitle: `Canal: ${((data === null || data === void 0 ? void 0 : data.channel) || 'whatsapp').toUpperCase()} • Tipo: ${(data === null || data === void 0 ? void 0 : data.mode) || 'text'}`,\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(Pin, {\n    type: \"target\",\n    position: Position.Left,\n    color: \"#64748b\",\n    id: \"in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Pin, {\n    type: \"source\",\n    position: Position.Right,\n    color: \"#16a34a\",\n    id: \"out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 90,\n  columnNumber: 3\n}, this);\n_c8 = FreeFormNode;\nconst nodeTypes = {\n  start: StartNode,\n  end: EndNode,\n  message: MessageNode,\n  api: ApiNode,\n  code: CodeNode,\n  freeform: FreeFormNode\n};\n\n// ---------- Builder ----------\nconst START_X = 220,\n  START_Y = 280,\n  GAP_X = 320;\nexport default function JourneyBuilder() {\n  _s();\n  const [nodes, setNodes, onNodesChange] = useNodesState([{\n    id: 'start',\n    type: 'start',\n    position: {\n      x: START_X,\n      y: START_Y\n    },\n    data: {}\n  }, {\n    id: 'end',\n    type: 'end',\n    position: {\n      x: START_X + GAP_X * 2,\n      y: START_Y - 10\n    },\n    data: {}\n  }]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [selectedId, setSelectedId] = useState(null);\n\n  // Templates Twilio\n  const [templates, setTemplates] = useState([]);\n  useEffect(() => {\n    fetch('/api/templates/list').then(r => r.json()).then(d => setTemplates((d === null || d === void 0 ? void 0 : d.contents) || [])).catch(() => setTemplates([]));\n  }, []);\n  const selectedNode = useMemo(() => nodes.find(n => n.id === selectedId), [nodes, selectedId]);\n  const patchNode = patch => {\n    if (!selectedNode) return;\n    setNodes(ns => ns.map(n => n.id === selectedNode.id ? {\n      ...n,\n      data: {\n        ...n.data,\n        ...patch\n      }\n    } : n));\n  };\n\n  // Regra: 1 saída por nó; Start não recebe entrada; End não gera saída\n  const isValidConnection = conn => {\n    const sourceNode = nodes.find(n => n.id === conn.source);\n    const targetNode = nodes.find(n => n.id === conn.target);\n    if (!sourceNode || !targetNode) return false;\n    if (sourceNode.id === targetNode.id) return false;\n    if (sourceNode.type === 'end') return false; // end não sai\n    if (targetNode.type === 'start') return false; // start não entra\n    // já tem saída?\n    if (edges.some(e => e.source === conn.source)) return false;\n    return true;\n  };\n  const onConnect = params => {\n    if (!isValidConnection(params)) {\n      alert('Cada nó só pode ter 1 saída. Start não recebe entrada e End não tem saída.');\n      return;\n    }\n    setEdges(eds => addEdge({\n      ...params,\n      type: 'smoothstep'\n    }, eds));\n  };\n  const onNodeClick = (_, node) => setSelectedId(node.id);\n  const onSelectionChange = ({\n    nodes: sel\n  }) => {\n    var _sel$;\n    return setSelectedId((sel === null || sel === void 0 ? void 0 : (_sel$ = sel[0]) === null || _sel$ === void 0 ? void 0 : _sel$.id) || null);\n  };\n\n  // Add nós\n  const addNode = type => {\n    const id = `${type}_${Date.now()}`;\n    const base = {\n      id,\n      type,\n      position: {\n        x: START_X + GAP_X,\n        y: START_Y + 140\n      },\n      data: {}\n    };\n    if (type === 'message') base.data = {\n      label: 'Bem-vindo!',\n      templateSid: '',\n      templateName: ''\n    };\n    if (type === 'api') base.data = {\n      label: 'API Call',\n      method: 'GET',\n      url: '',\n      headers: '{}',\n      body: '{}'\n    };\n    if (type === 'code') base.data = {\n      label: 'Code',\n      code: '// return { ok: true }'\n    };\n    if (type === 'freeform') base.data = {\n      label: 'Free Form',\n      channel: 'whatsapp',\n      mode: 'text',\n      text: 'Olá {{nome}}!'\n    };\n    setNodes(ns => [...ns, base]);\n    setSelectedId(id);\n  };\n  const duplicateSelected = () => {\n    if (!selectedNode) return;\n    const id = `${selectedNode.type}_${Date.now()}`;\n    setNodes(ns => [...ns, {\n      ...selectedNode,\n      id,\n      position: {\n        x: selectedNode.position.x + 40,\n        y: selectedNode.position.y + 40\n      }\n    }]);\n    setSelectedId(id);\n  };\n  const deleteSelected = () => {\n    if (!selectedNode) return;\n    setEdges(eds => eds.filter(e => e.source !== selectedNode.id && e.target !== selectedNode.id));\n    setNodes(ns => ns.filter(n => n.id !== selectedNode.id));\n    setSelectedId(null);\n  };\n\n  // Sidebar por tipo\n  const Sidebar = () => {\n    if (!selectedNode) return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#94a3b8'\n      },\n      children: \"Selecione um n\\xF3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 31\n    }, this);\n    const t = selectedNode.type;\n    const d = selectedNode.data || {};\n    const L = ({\n      children\n    }) => /*#__PURE__*/_jsxDEV(\"label\", {\n      style: {\n        display: 'block',\n        marginTop: 12,\n        fontSize: 12,\n        color: '#334155'\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 33\n    }, this);\n    const In = props => /*#__PURE__*/_jsxDEV(\"input\", {\n      ...props,\n      style: {\n        width: '100%',\n        padding: 8,\n        border: '1px solid #e5e7eb',\n        borderRadius: 8\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 27\n    }, this);\n    const Tx = props => /*#__PURE__*/_jsxDEV(\"textarea\", {\n      ...props,\n      style: {\n        width: '100%',\n        padding: 8,\n        border: '1px solid #e5e7eb',\n        borderRadius: 8\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 27\n    }, this);\n    const Sl = props => /*#__PURE__*/_jsxDEV(\"select\", {\n      ...props,\n      style: {\n        width: '100%',\n        padding: 8,\n        border: '1px solid #e5e7eb',\n        borderRadius: 8\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 27\n    }, this);\n    if (t === 'message') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(L, {\n          children: \"Label\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(In, {\n          value: d.label || '',\n          onChange: e => patchNode({\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Template Twilio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Sl, {\n          value: d.templateSid || '',\n          onChange: e => {\n            const sid = e.target.value;\n            const t = templates.find(x => x.sid === sid);\n            patchNode({\n              templateSid: sid,\n              templateName: (t === null || t === void 0 ? void 0 : t.friendly_name) || ''\n            });\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"\\u2014 selecione \\u2014\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this), templates.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: t.sid,\n            children: t.friendly_name\n          }, t.sid, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), !!d.templateSid && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(L, {\n            children: \"Preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Tx, {\n            rows: 5,\n            readOnly: true,\n            value: (_Object$values$ => {\n              const t = templates.find(x => x.sid === d.templateSid);\n              return t ? ((_Object$values$ = Object.values(t.types)[0]) === null || _Object$values$ === void 0 ? void 0 : _Object$values$.body) || '' : '';\n            })()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'api') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(L, {\n          children: \"Label\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(In, {\n          value: d.label || '',\n          onChange: e => patchNode({\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"M\\xE9todo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Sl, {\n          value: d.method || 'GET',\n          onChange: e => patchNode({\n            method: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"GET\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"POST\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"PUT\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 54\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"PATCH\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 74\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"DELETE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 96\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"URL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(In, {\n          placeholder: \"https://api.seuservico.com/...\",\n          value: d.url || '',\n          onChange: e => patchNode({\n            url: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Headers (JSON)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tx, {\n          rows: 3,\n          value: d.headers || '{}',\n          onChange: e => patchNode({\n            headers: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Body (JSON)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tx, {\n          rows: 4,\n          value: d.body || '{}',\n          onChange: e => patchNode({\n            body: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'code') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(L, {\n          children: \"Label\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(In, {\n          value: d.label || '',\n          onChange: e => patchNode({\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"JavaScript\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tx, {\n          rows: 10,\n          value: d.code || '',\n          onChange: e => patchNode({\n            code: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'freeform') {\n      const tmplBody = d.templateSid ? (_Object$values$2 => {\n        const t = templates.find(tt => tt.sid === d.templateSid);\n        return t ? ((_Object$values$2 = Object.values(t.types)[0]) === null || _Object$values$2 === void 0 ? void 0 : _Object$values$2.body) || '' : '';\n      })() : '';\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(L, {\n          children: \"Label\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(In, {\n          value: d.label || '',\n          onChange: e => patchNode({\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Channel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Sl, {\n          value: d.channel || 'whatsapp',\n          onChange: e => patchNode({\n            channel: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"whatsapp\",\n            children: \"WhatsApp\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"sms\",\n            children: \"SMS\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Mode\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Sl, {\n          value: d.mode || 'text',\n          onChange: e => patchNode({\n            mode: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"text\",\n            children: \"Text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"image\",\n            children: \"Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"rich\",\n            children: \"Rich (text + image + buttons)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(L, {\n          children: \"Pick a Twilio template (optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Sl, {\n          value: d.templateSid || '',\n          onChange: e => {\n            const sid = e.target.value;\n            const t = templates.find(x => x.sid === sid);\n            patchNode({\n              templateSid: sid,\n              templateName: (t === null || t === void 0 ? void 0 : t.friendly_name) || ''\n            });\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"\\u2014 none \\u2014\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), templates.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: t.sid,\n            children: t.friendly_name\n          }, t.sid, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), (d.mode === 'text' || d.mode === 'rich') && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(L, {\n            children: \"Text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Tx, {\n            rows: 4,\n            value: d.text || '',\n            onChange: e => patchNode({\n              text: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), (d.mode === 'image' || d.mode === 'rich') && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(L, {\n            children: \"Media URL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(In, {\n            value: d.mediaUrl || '',\n            onChange: e => patchNode({\n              mediaUrl: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), d.templateSid && tmplBody ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(L, {\n            children: \"Template preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Tx, {\n            rows: 4,\n            readOnly: true,\n            value: tmplBody\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this);\n    }\n\n    // genérico\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(L, {\n        children: \"Label\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(In, {\n        value: d.label || '',\n        onChange: e => patchNode({\n          label: e.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 360px',\n      gap: 16,\n      height: 'calc(100vh - 140px)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          marginBottom: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addNode('message'),\n          children: \"+ Message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addNode('api'),\n          children: \"+ API\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addNode('code'),\n          children: \"+ Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addNode('freeform'),\n          children: \"+ FreeForm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: duplicateSelected,\n          children: \"Duplicar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: deleteSelected,\n          children: \"Delete selected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: 'calc(100vh - 200px)',\n          border: '1px solid #e5e7eb',\n          borderRadius: 12\n        },\n        children: /*#__PURE__*/_jsxDEV(ReactFlow, {\n          nodes: nodes,\n          edges: edges,\n          nodeTypes: nodeTypes,\n          onNodesChange: onNodesChange,\n          onEdgesChange: onEdgesChange,\n          onConnect: onConnect,\n          onNodeClick: onNodeClick,\n          onSelectionChange: onSelectionChange,\n          fitView: true,\n          selectionOnDrag: false,\n          connectionRadius: 28,\n          defaultEdgeOptions: {\n            type: 'smoothstep'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Background, {\n            gap: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MiniMap, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: '1px solid #e5e7eb',\n        borderRadius: 12,\n        padding: 12,\n        overflow: 'auto',\n        height: 'calc(100vh - 200px)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          margin: '6px 0 12px'\n        },\n        children: \"Propriedades do N\\xF3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Sidebar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 16,\n          color: '#94a3b8',\n          fontSize: 12\n        },\n        children: [\"Dicas: arraste do pino \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"verde\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 34\n        }, this), \" para o pino \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"cinza\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 59\n        }, this), \". Cada n\\xF3 s\\xF3 pode ter \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"1 sa\\xEDda\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 93\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 322,\n    columnNumber: 5\n  }, this);\n}\n_s(JourneyBuilder, \"VURhV3+Jc5FCXUWdREvcRoD1LG0=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c9 = JourneyBuilder;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9;\n$RefreshReg$(_c, \"Pin\");\n$RefreshReg$(_c2, \"Shell\");\n$RefreshReg$(_c3, \"StartNode\");\n$RefreshReg$(_c4, \"EndNode\");\n$RefreshReg$(_c5, \"MessageNode\");\n$RefreshReg$(_c6, \"ApiNode\");\n$RefreshReg$(_c7, \"CodeNode\");\n$RefreshReg$(_c8, \"FreeFormNode\");\n$RefreshReg$(_c9, \"JourneyBuilder\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","ReactFlow","Background","Controls","MiniMap","addEdge","useEdgesState","useNodesState","Handle","Position","jsxDEV","_jsxDEV","Fragment","_Fragment","Pin","type","position","color","id","style","width","height","background","border","boxShadow","fileName","_jsxFileName","lineNumber","columnNumber","_c","Shell","title","subtitle","selected","children","minWidth","borderRadius","padding","fontWeight","marginBottom","fontSize","_c2","StartNode","Right","_c3","EndNode","Left","_c4","MessageNode","data","label","templateName","_c5","ApiNode","method","toUpperCase","_c6","CodeNode","_c7","FreeFormNode","channel","mode","_c8","nodeTypes","start","end","message","api","code","freeform","START_X","START_Y","GAP_X","JourneyBuilder","_s","nodes","setNodes","onNodesChange","x","y","edges","setEdges","onEdgesChange","selectedId","setSelectedId","templates","setTemplates","fetch","then","r","json","d","contents","catch","selectedNode","find","n","patchNode","patch","ns","map","isValidConnection","conn","sourceNode","source","targetNode","target","some","e","onConnect","params","alert","eds","onNodeClick","_","node","onSelectionChange","sel","_sel$","addNode","Date","now","base","templateSid","url","headers","body","text","duplicateSelected","deleteSelected","filter","Sidebar","t","L","display","marginTop","In","props","Tx","Sl","value","onChange","sid","friendly_name","rows","readOnly","_Object$values$","Object","values","types","placeholder","tmplBody","_Object$values$2","tt","mediaUrl","gridTemplateColumns","gap","onClick","fitView","selectionOnDrag","connectionRadius","defaultEdgeOptions","overflow","margin","_c9","$RefreshReg$"],"sources":["/Users/gustsantos/Desktop/initucastt/frontend/src/pages/JourneyBuilder.jsx"],"sourcesContent":["// frontend/src/pages/JourneyBuilder.jsx\nimport React, { useEffect, useMemo, useState } from 'react';\nimport ReactFlow, {\n  Background,\n  Controls,\n  MiniMap,\n  addEdge,\n  useEdgesState,\n  useNodesState,\n  Handle,\n  Position\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\n\n// ---------- NODES (com Handle real e pinos coloridos) ----------\nconst Pin = ({ type, position, color = '#64748b', id }) => (\n  <Handle\n    type={type}\n    position={position}\n    id={id}\n    style={{\n      width: 14,\n      height: 14,\n      background: '#fff',\n      border: `2px solid ${color}`,\n      boxShadow: '0 0 0 2px #eef2ff inset'\n    }}\n  />\n);\n\nconst Shell = ({ title, subtitle, selected, children }) => (\n  <div\n    style={{\n      minWidth: 240,\n      background: '#fff',\n      border: selected ? '2px solid #2563eb' : '1px solid #e5e7eb',\n      borderRadius: 12,\n      padding: '12px 14px',\n      boxShadow: '0 2px 8px rgba(0,0,0,0.05)'\n    }}\n  >\n    <div style={{ fontWeight: 700, marginBottom: 6 }}>{title}</div>\n    {subtitle ? <div style={{ fontSize: 12, color: '#475569' }}>{subtitle}</div> : null}\n    {children}\n  </div>\n);\n\nconst StartNode = ({ selected }) => (\n  <Shell title=\"Start\" subtitle=\"início do fluxo\" selected={selected}>\n    <Pin type=\"source\" position={Position.Right} color=\"#16a34a\" id=\"out\" />\n  </Shell>\n);\n\nconst EndNode = ({ selected }) => (\n  <Shell title=\"End\" subtitle=\"término do fluxo\" selected={selected}>\n    <Pin type=\"target\" position={Position.Left} color=\"#ef4444\" id=\"in\" />\n  </Shell>\n);\n\nconst MessageNode = ({ data, selected }) => (\n  <Shell\n    title={data?.label || 'Message'}\n    subtitle={`Template: ${data?.templateName || '—'}`}\n    selected={selected}\n  >\n    <Pin type=\"target\" position={Position.Left} color=\"#64748b\" id=\"in\" />\n    <Pin type=\"source\" position={Position.Right} color=\"#16a34a\" id=\"out\" />\n  </Shell>\n);\n\nconst ApiNode = ({ data, selected }) => (\n  <Shell\n    title={data?.label || 'API Call'}\n    subtitle={`${(data?.method || 'GET').toUpperCase()}`}\n    selected={selected}\n  >\n    <Pin type=\"target\" position={Position.Left} color=\"#64748b\" id=\"in\" />\n    <Pin type=\"source\" position={Position.Right} color=\"#16a34a\" id=\"out\" />\n  </Shell>\n);\n\nconst CodeNode = ({ data, selected }) => (\n  <Shell title={data?.label || 'Code'} subtitle=\"JavaScript step\" selected={selected}>\n    <Pin type=\"target\" position={Position.Left} color=\"#64748b\" id=\"in\" />\n    <Pin type=\"source\" position={Position.Right} color=\"#16a34a\" id=\"out\" />\n  </Shell>\n);\n\nconst FreeFormNode = ({ data, selected }) => (\n  <Shell\n    title={data?.label || 'Free Form'}\n    subtitle={`Canal: ${(data?.channel || 'whatsapp').toUpperCase()} • Tipo: ${data?.mode || 'text'}`}\n    selected={selected}\n  >\n    <Pin type=\"target\" position={Position.Left} color=\"#64748b\" id=\"in\" />\n    <Pin type=\"source\" position={Position.Right} color=\"#16a34a\" id=\"out\" />\n  </Shell>\n);\n\nconst nodeTypes = {\n  start: StartNode,\n  end: EndNode,\n  message: MessageNode,\n  api: ApiNode,\n  code: CodeNode,\n  freeform: FreeFormNode\n};\n\n// ---------- Builder ----------\nconst START_X = 220, START_Y = 280, GAP_X = 320;\n\nexport default function JourneyBuilder() {\n  const [nodes, setNodes, onNodesChange] = useNodesState([\n    { id: 'start', type: 'start', position: { x: START_X, y: START_Y }, data: {} },\n    { id: 'end',   type: 'end',   position: { x: START_X + GAP_X * 2, y: START_Y - 10 }, data: {} }\n  ]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [selectedId, setSelectedId] = useState(null);\n\n  // Templates Twilio\n  const [templates, setTemplates] = useState([]);\n  useEffect(() => {\n    fetch('/api/templates/list')\n      .then(r => r.json())\n      .then(d => setTemplates(d?.contents || []))\n      .catch(() => setTemplates([]));\n  }, []);\n\n  const selectedNode = useMemo(() => nodes.find(n => n.id === selectedId), [nodes, selectedId]);\n  const patchNode = (patch) => {\n    if (!selectedNode) return;\n    setNodes(ns => ns.map(n => n.id === selectedNode.id ? { ...n, data: { ...n.data, ...patch } } : n));\n  };\n\n  // Regra: 1 saída por nó; Start não recebe entrada; End não gera saída\n  const isValidConnection = (conn) => {\n    const sourceNode = nodes.find(n => n.id === conn.source);\n    const targetNode = nodes.find(n => n.id === conn.target);\n    if (!sourceNode || !targetNode) return false;\n    if (sourceNode.id === targetNode.id) return false;\n    if (sourceNode.type === 'end') return false;         // end não sai\n    if (targetNode.type === 'start') return false;       // start não entra\n    // já tem saída?\n    if (edges.some(e => e.source === conn.source)) return false;\n    return true;\n  };\n\n  const onConnect = (params) => {\n    if (!isValidConnection(params)) {\n      alert('Cada nó só pode ter 1 saída. Start não recebe entrada e End não tem saída.');\n      return;\n    }\n    setEdges(eds => addEdge({ ...params, type: 'smoothstep' }, eds));\n  };\n\n  const onNodeClick = (_, node) => setSelectedId(node.id);\n  const onSelectionChange = ({ nodes: sel }) => setSelectedId(sel?.[0]?.id || null);\n\n  // Add nós\n  const addNode = (type) => {\n    const id = `${type}_${Date.now()}`;\n    const base = { id, type, position: { x: START_X + GAP_X, y: START_Y + 140 }, data: {} };\n    if (type === 'message') base.data = { label: 'Bem-vindo!', templateSid: '', templateName: '' };\n    if (type === 'api')     base.data = { label: 'API Call', method: 'GET', url: '', headers: '{}', body: '{}' };\n    if (type === 'code')    base.data = { label: 'Code', code: '// return { ok: true }' };\n    if (type === 'freeform')base.data = { label: 'Free Form', channel: 'whatsapp', mode: 'text', text: 'Olá {{nome}}!' };\n    setNodes(ns => [...ns, base]);\n    setSelectedId(id);\n  };\n\n  const duplicateSelected = () => {\n    if (!selectedNode) return;\n    const id = `${selectedNode.type}_${Date.now()}`;\n    setNodes(ns => [...ns, { ...selectedNode, id, position: { x: selectedNode.position.x + 40, y: selectedNode.position.y + 40 } }]);\n    setSelectedId(id);\n  };\n\n  const deleteSelected = () => {\n    if (!selectedNode) return;\n    setEdges(eds => eds.filter(e => e.source !== selectedNode.id && e.target !== selectedNode.id));\n    setNodes(ns => ns.filter(n => n.id !== selectedNode.id));\n    setSelectedId(null);\n  };\n\n  // Sidebar por tipo\n  const Sidebar = () => {\n    if (!selectedNode) return <div style={{ color: '#94a3b8' }}>Selecione um nó</div>;\n    const t = selectedNode.type;\n    const d = selectedNode.data || {};\n\n    const L = ({ children }) => <label style={{ display: 'block', marginTop: 12, fontSize: 12, color: '#334155' }}>{children}</label>;\n    const In = (props) => <input {...props} style={{ width: '100%', padding: 8, border: '1px solid #e5e7eb', borderRadius: 8 }} />;\n    const Tx = (props) => <textarea {...props} style={{ width: '100%', padding: 8, border: '1px solid #e5e7eb', borderRadius: 8 }} />;\n    const Sl = (props) => <select {...props} style={{ width: '100%', padding: 8, border: '1px solid #e5e7eb', borderRadius: 8 }} />;\n\n    if (t === 'message') {\n      return (\n        <div>\n          <L>Label</L>\n          <In value={d.label || ''} onChange={e => patchNode({ label: e.target.value })} />\n          <L>Template Twilio</L>\n          <Sl\n            value={d.templateSid || ''}\n            onChange={e => {\n              const sid = e.target.value;\n              const t = templates.find(x => x.sid === sid);\n              patchNode({ templateSid: sid, templateName: t?.friendly_name || '' });\n            }}\n          >\n            <option value=\"\">— selecione —</option>\n            {templates.map(t => <option key={t.sid} value={t.sid}>{t.friendly_name}</option>)}\n          </Sl>\n          {!!d.templateSid && (\n            <>\n              <L>Preview</L>\n              <Tx rows={5} readOnly value={(() => {\n                const t = templates.find(x => x.sid === d.templateSid);\n                return t ? (Object.values(t.types)[0]?.body || '') : '';\n              })()} />\n            </>\n          )}\n        </div>\n      );\n    }\n\n    if (t === 'api') {\n      return (\n        <div>\n          <L>Label</L>\n          <In value={d.label || ''} onChange={e => patchNode({ label: e.target.value })} />\n          <L>Método</L>\n          <Sl value={d.method || 'GET'} onChange={e => patchNode({ method: e.target.value })}>\n            <option>GET</option><option>POST</option><option>PUT</option><option>PATCH</option><option>DELETE</option>\n          </Sl>\n          <L>URL</L>\n          <In placeholder=\"https://api.seuservico.com/...\" value={d.url || ''} onChange={e => patchNode({ url: e.target.value })} />\n          <L>Headers (JSON)</L>\n          <Tx rows={3} value={d.headers || '{}'} onChange={e => patchNode({ headers: e.target.value })} />\n          <L>Body (JSON)</L>\n          <Tx rows={4} value={d.body || '{}'} onChange={e => patchNode({ body: e.target.value })} />\n        </div>\n      );\n    }\n\n    if (t === 'code') {\n      return (\n        <div>\n          <L>Label</L>\n          <In value={d.label || ''} onChange={e => patchNode({ label: e.target.value })} />\n          <L>JavaScript</L>\n          <Tx rows={10} value={d.code || ''} onChange={e => patchNode({ code: e.target.value })} />\n        </div>\n      );\n    }\n\n    if (t === 'freeform') {\n      const tmplBody = d.templateSid\n        ? (() => {\n            const t = templates.find(tt => tt.sid === d.templateSid);\n            return t ? (Object.values(t.types)[0]?.body || '') : '';\n          })()\n        : '';\n      return (\n        <div>\n          <L>Label</L>\n          <In value={d.label || ''} onChange={e => patchNode({ label: e.target.value })} />\n          <L>Channel</L>\n          <Sl value={d.channel || 'whatsapp'} onChange={e => patchNode({ channel: e.target.value })}>\n            <option value=\"whatsapp\">WhatsApp</option>\n            <option value=\"sms\">SMS</option>\n          </Sl>\n          <L>Mode</L>\n          <Sl value={d.mode || 'text'} onChange={e => patchNode({ mode: e.target.value })}>\n            <option value=\"text\">Text</option>\n            <option value=\"image\">Image</option>\n            <option value=\"rich\">Rich (text + image + buttons)</option>\n          </Sl>\n          <L>Pick a Twilio template (optional)</L>\n          <Sl\n            value={d.templateSid || ''}\n            onChange={e => {\n              const sid = e.target.value;\n              const t = templates.find(x => x.sid === sid);\n              patchNode({ templateSid: sid, templateName: t?.friendly_name || '' });\n            }}\n          >\n            <option value=\"\">— none —</option>\n            {templates.map(t => <option key={t.sid} value={t.sid}>{t.friendly_name}</option>)}\n          </Sl>\n          {(d.mode === 'text' || d.mode === 'rich') && (\n            <>\n              <L>Text</L>\n              <Tx rows={4} value={d.text || ''} onChange={e => patchNode({ text: e.target.value })} />\n            </>\n          )}\n          {(d.mode === 'image' || d.mode === 'rich') && (\n            <>\n              <L>Media URL</L>\n              <In value={d.mediaUrl || ''} onChange={e => patchNode({ mediaUrl: e.target.value })} />\n            </>\n          )}\n          {d.templateSid && tmplBody ? (\n            <>\n              <L>Template preview</L>\n              <Tx rows={4} readOnly value={tmplBody} />\n            </>\n          ) : null}\n        </div>\n      );\n    }\n\n    // genérico\n    return (\n      <div>\n        <L>Label</L>\n        <In value={d.label || ''} onChange={e => patchNode({ label: e.target.value })} />\n      </div>\n    );\n  };\n\n  return (\n    <div style={{ display: 'grid', gridTemplateColumns: '1fr 360px', gap: 16, height: 'calc(100vh - 140px)' }}>\n      <div>\n        <div style={{ display: 'flex', gap: 8, marginBottom: 10 }}>\n          <button onClick={() => addNode('message')}>+ Message</button>\n          <button onClick={() => addNode('api')}>+ API</button>\n          <button onClick={() => addNode('code')}>+ Code</button>\n          <button onClick={() => addNode('freeform')}>+ FreeForm</button>\n          <button onClick={duplicateSelected}>Duplicar</button>\n          <button onClick={deleteSelected}>Delete selected</button>\n        </div>\n\n        <div style={{ height: 'calc(100vh - 200px)', border: '1px solid #e5e7eb', borderRadius: 12 }}>\n          <ReactFlow\n            nodes={nodes}\n            edges={edges}\n            nodeTypes={nodeTypes}\n            onNodesChange={onNodesChange}\n            onEdgesChange={onEdgesChange}\n            onConnect={onConnect}\n            onNodeClick={onNodeClick}\n            onSelectionChange={onSelectionChange}\n            fitView\n            selectionOnDrag={false}\n            connectionRadius={28}\n            defaultEdgeOptions={{ type: 'smoothstep' }}\n          >\n            <Background gap={16} />\n            <MiniMap />\n            <Controls />\n          </ReactFlow>\n        </div>\n      </div>\n\n      <div style={{ border: '1px solid #e5e7eb', borderRadius: 12, padding: 12, overflow: 'auto', height: 'calc(100vh - 200px)' }}>\n        <h4 style={{ margin: '6px 0 12px' }}>Propriedades do Nó</h4>\n        <Sidebar />\n        <div style={{ marginTop: 16, color: '#94a3b8', fontSize: 12 }}>\n          Dicas: arraste do pino <b>verde</b> para o pino <b>cinza</b>. Cada nó só pode ter <b>1 saída</b>.\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAC3D,OAAOC,SAAS,IACdC,UAAU,EACVC,QAAQ,EACRC,OAAO,EACPC,OAAO,EACPC,aAAa,EACbC,aAAa,EACbC,MAAM,EACNC,QAAQ,QACH,WAAW;AAClB,OAAO,0BAA0B;;AAEjC;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,GAAG,GAAGA,CAAC;EAAEC,IAAI;EAAEC,QAAQ;EAAEC,KAAK,GAAG,SAAS;EAAEC;AAAG,CAAC,kBACpDP,OAAA,CAACH,MAAM;EACLO,IAAI,EAAEA,IAAK;EACXC,QAAQ,EAAEA,QAAS;EACnBE,EAAE,EAAEA,EAAG;EACPC,KAAK,EAAE;IACLC,KAAK,EAAE,EAAE;IACTC,MAAM,EAAE,EAAE;IACVC,UAAU,EAAE,MAAM;IAClBC,MAAM,EAAE,aAAaN,KAAK,EAAE;IAC5BO,SAAS,EAAE;EACb;AAAE;EAAAC,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACH,CACF;AAACC,EAAA,GAbIf,GAAG;AAeT,MAAMgB,KAAK,GAAGA,CAAC;EAAEC,KAAK;EAAEC,QAAQ;EAAEC,QAAQ;EAAEC;AAAS,CAAC,kBACpDvB,OAAA;EACEQ,KAAK,EAAE;IACLgB,QAAQ,EAAE,GAAG;IACbb,UAAU,EAAE,MAAM;IAClBC,MAAM,EAAEU,QAAQ,GAAG,mBAAmB,GAAG,mBAAmB;IAC5DG,YAAY,EAAE,EAAE;IAChBC,OAAO,EAAE,WAAW;IACpBb,SAAS,EAAE;EACb,CAAE;EAAAU,QAAA,gBAEFvB,OAAA;IAAKQ,KAAK,EAAE;MAAEmB,UAAU,EAAE,GAAG;MAAEC,YAAY,EAAE;IAAE,CAAE;IAAAL,QAAA,EAAEH;EAAK;IAAAN,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAM,CAAC,EAC9DI,QAAQ,gBAAGrB,OAAA;IAAKQ,KAAK,EAAE;MAAEqB,QAAQ,EAAE,EAAE;MAAEvB,KAAK,EAAE;IAAU,CAAE;IAAAiB,QAAA,EAAEF;EAAQ;IAAAP,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAM,CAAC,GAAG,IAAI,EAClFM,QAAQ;AAAA;EAAAT,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACN,CACN;AAACa,GAAA,GAfIX,KAAK;AAiBX,MAAMY,SAAS,GAAGA,CAAC;EAAET;AAAS,CAAC,kBAC7BtB,OAAA,CAACmB,KAAK;EAACC,KAAK,EAAC,OAAO;EAACC,QAAQ,EAAC,oBAAiB;EAACC,QAAQ,EAAEA,QAAS;EAAAC,QAAA,eACjEvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACkC,KAAM;IAAC1B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAK;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACnE,CACR;AAACgB,GAAA,GAJIF,SAAS;AAMf,MAAMG,OAAO,GAAGA,CAAC;EAAEZ;AAAS,CAAC,kBAC3BtB,OAAA,CAACmB,KAAK;EAACC,KAAK,EAAC,KAAK;EAACC,QAAQ,EAAC,qBAAkB;EAACC,QAAQ,EAAEA,QAAS;EAAAC,QAAA,eAChEvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACqC,IAAK;IAAC7B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAI;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACjE,CACR;AAACmB,GAAA,GAJIF,OAAO;AAMb,MAAMG,WAAW,GAAGA,CAAC;EAAEC,IAAI;EAAEhB;AAAS,CAAC,kBACrCtB,OAAA,CAACmB,KAAK;EACJC,KAAK,EAAE,CAAAkB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,KAAK,KAAI,SAAU;EAChClB,QAAQ,EAAE,aAAa,CAAAiB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEE,YAAY,KAAI,GAAG,EAAG;EACnDlB,QAAQ,EAAEA,QAAS;EAAAC,QAAA,gBAEnBvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACqC,IAAK;IAAC7B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAI;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC,eACtEjB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACkC,KAAM;IAAC1B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAK;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAAA;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACnE,CACR;AAACwB,GAAA,GATIJ,WAAW;AAWjB,MAAMK,OAAO,GAAGA,CAAC;EAAEJ,IAAI;EAAEhB;AAAS,CAAC,kBACjCtB,OAAA,CAACmB,KAAK;EACJC,KAAK,EAAE,CAAAkB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,KAAK,KAAI,UAAW;EACjClB,QAAQ,EAAE,GAAG,CAAC,CAAAiB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEK,MAAM,KAAI,KAAK,EAAEC,WAAW,CAAC,CAAC,EAAG;EACrDtB,QAAQ,EAAEA,QAAS;EAAAC,QAAA,gBAEnBvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACqC,IAAK;IAAC7B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAI;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC,eACtEjB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACkC,KAAM;IAAC1B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAK;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAAA;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACnE,CACR;AAAC4B,GAAA,GATIH,OAAO;AAWb,MAAMI,QAAQ,GAAGA,CAAC;EAAER,IAAI;EAAEhB;AAAS,CAAC,kBAClCtB,OAAA,CAACmB,KAAK;EAACC,KAAK,EAAE,CAAAkB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,KAAK,KAAI,MAAO;EAAClB,QAAQ,EAAC,iBAAiB;EAACC,QAAQ,EAAEA,QAAS;EAAAC,QAAA,gBACjFvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACqC,IAAK;IAAC7B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAI;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC,eACtEjB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACkC,KAAM;IAAC1B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAK;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAAA;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACnE,CACR;AAAC8B,GAAA,GALID,QAAQ;AAOd,MAAME,YAAY,GAAGA,CAAC;EAAEV,IAAI;EAAEhB;AAAS,CAAC,kBACtCtB,OAAA,CAACmB,KAAK;EACJC,KAAK,EAAE,CAAAkB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,KAAK,KAAI,WAAY;EAClClB,QAAQ,EAAE,UAAU,CAAC,CAAAiB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEW,OAAO,KAAI,UAAU,EAAEL,WAAW,CAAC,CAAC,YAAY,CAAAN,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEY,IAAI,KAAI,MAAM,EAAG;EAClG5B,QAAQ,EAAEA,QAAS;EAAAC,QAAA,gBAEnBvB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACqC,IAAK;IAAC7B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAI;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC,eACtEjB,OAAA,CAACG,GAAG;IAACC,IAAI,EAAC,QAAQ;IAACC,QAAQ,EAAEP,QAAQ,CAACkC,KAAM;IAAC1B,KAAK,EAAC,SAAS;IAACC,EAAE,EAAC;EAAK;IAAAO,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAAA;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACnE,CACR;AAACkC,GAAA,GATIH,YAAY;AAWlB,MAAMI,SAAS,GAAG;EAChBC,KAAK,EAAEtB,SAAS;EAChBuB,GAAG,EAAEpB,OAAO;EACZqB,OAAO,EAAElB,WAAW;EACpBmB,GAAG,EAAEd,OAAO;EACZe,IAAI,EAAEX,QAAQ;EACdY,QAAQ,EAAEV;AACZ,CAAC;;AAED;AACA,MAAMW,OAAO,GAAG,GAAG;EAAEC,OAAO,GAAG,GAAG;EAAEC,KAAK,GAAG,GAAG;AAE/C,eAAe,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EACvC,MAAM,CAACC,KAAK,EAAEC,QAAQ,EAAEC,aAAa,CAAC,GAAGtE,aAAa,CAAC,CACrD;IAAEW,EAAE,EAAE,OAAO;IAAEH,IAAI,EAAE,OAAO;IAAEC,QAAQ,EAAE;MAAE8D,CAAC,EAAER,OAAO;MAAES,CAAC,EAAER;IAAQ,CAAC;IAAEtB,IAAI,EAAE,CAAC;EAAE,CAAC,EAC9E;IAAE/B,EAAE,EAAE,KAAK;IAAIH,IAAI,EAAE,KAAK;IAAIC,QAAQ,EAAE;MAAE8D,CAAC,EAAER,OAAO,GAAGE,KAAK,GAAG,CAAC;MAAEO,CAAC,EAAER,OAAO,GAAG;IAAG,CAAC;IAAEtB,IAAI,EAAE,CAAC;EAAE,CAAC,CAChG,CAAC;EACF,MAAM,CAAC+B,KAAK,EAAEC,QAAQ,EAAEC,aAAa,CAAC,GAAG5E,aAAa,CAAC,EAAE,CAAC;EAC1D,MAAM,CAAC6E,UAAU,EAAEC,aAAa,CAAC,GAAGpF,QAAQ,CAAC,IAAI,CAAC;;EAElD;EACA,MAAM,CAACqF,SAAS,EAAEC,YAAY,CAAC,GAAGtF,QAAQ,CAAC,EAAE,CAAC;EAC9CF,SAAS,CAAC,MAAM;IACdyF,KAAK,CAAC,qBAAqB,CAAC,CACzBC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CACnBF,IAAI,CAACG,CAAC,IAAIL,YAAY,CAAC,CAAAK,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEC,QAAQ,KAAI,EAAE,CAAC,CAAC,CAC1CC,KAAK,CAAC,MAAMP,YAAY,CAAC,EAAE,CAAC,CAAC;EAClC,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMQ,YAAY,GAAG/F,OAAO,CAAC,MAAM4E,KAAK,CAACoB,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC9E,EAAE,KAAKiE,UAAU,CAAC,EAAE,CAACR,KAAK,EAAEQ,UAAU,CAAC,CAAC;EAC7F,MAAMc,SAAS,GAAIC,KAAK,IAAK;IAC3B,IAAI,CAACJ,YAAY,EAAE;IACnBlB,QAAQ,CAACuB,EAAE,IAAIA,EAAE,CAACC,GAAG,CAACJ,CAAC,IAAIA,CAAC,CAAC9E,EAAE,KAAK4E,YAAY,CAAC5E,EAAE,GAAG;MAAE,GAAG8E,CAAC;MAAE/C,IAAI,EAAE;QAAE,GAAG+C,CAAC,CAAC/C,IAAI;QAAE,GAAGiD;MAAM;IAAE,CAAC,GAAGF,CAAC,CAAC,CAAC;EACrG,CAAC;;EAED;EACA,MAAMK,iBAAiB,GAAIC,IAAI,IAAK;IAClC,MAAMC,UAAU,GAAG5B,KAAK,CAACoB,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC9E,EAAE,KAAKoF,IAAI,CAACE,MAAM,CAAC;IACxD,MAAMC,UAAU,GAAG9B,KAAK,CAACoB,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC9E,EAAE,KAAKoF,IAAI,CAACI,MAAM,CAAC;IACxD,IAAI,CAACH,UAAU,IAAI,CAACE,UAAU,EAAE,OAAO,KAAK;IAC5C,IAAIF,UAAU,CAACrF,EAAE,KAAKuF,UAAU,CAACvF,EAAE,EAAE,OAAO,KAAK;IACjD,IAAIqF,UAAU,CAACxF,IAAI,KAAK,KAAK,EAAE,OAAO,KAAK,CAAC,CAAS;IACrD,IAAI0F,UAAU,CAAC1F,IAAI,KAAK,OAAO,EAAE,OAAO,KAAK,CAAC,CAAO;IACrD;IACA,IAAIiE,KAAK,CAAC2B,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACJ,MAAM,KAAKF,IAAI,CAACE,MAAM,CAAC,EAAE,OAAO,KAAK;IAC3D,OAAO,IAAI;EACb,CAAC;EAED,MAAMK,SAAS,GAAIC,MAAM,IAAK;IAC5B,IAAI,CAACT,iBAAiB,CAACS,MAAM,CAAC,EAAE;MAC9BC,KAAK,CAAC,4EAA4E,CAAC;MACnF;IACF;IACA9B,QAAQ,CAAC+B,GAAG,IAAI3G,OAAO,CAAC;MAAE,GAAGyG,MAAM;MAAE/F,IAAI,EAAE;IAAa,CAAC,EAAEiG,GAAG,CAAC,CAAC;EAClE,CAAC;EAED,MAAMC,WAAW,GAAGA,CAACC,CAAC,EAAEC,IAAI,KAAK/B,aAAa,CAAC+B,IAAI,CAACjG,EAAE,CAAC;EACvD,MAAMkG,iBAAiB,GAAGA,CAAC;IAAEzC,KAAK,EAAE0C;EAAI,CAAC;IAAA,IAAAC,KAAA;IAAA,OAAKlC,aAAa,CAAC,CAAAiC,GAAG,aAAHA,GAAG,wBAAAC,KAAA,GAAHD,GAAG,CAAG,CAAC,CAAC,cAAAC,KAAA,uBAARA,KAAA,CAAUpG,EAAE,KAAI,IAAI,CAAC;EAAA;;EAEjF;EACA,MAAMqG,OAAO,GAAIxG,IAAI,IAAK;IACxB,MAAMG,EAAE,GAAG,GAAGH,IAAI,IAAIyG,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IAClC,MAAMC,IAAI,GAAG;MAAExG,EAAE;MAAEH,IAAI;MAAEC,QAAQ,EAAE;QAAE8D,CAAC,EAAER,OAAO,GAAGE,KAAK;QAAEO,CAAC,EAAER,OAAO,GAAG;MAAI,CAAC;MAAEtB,IAAI,EAAE,CAAC;IAAE,CAAC;IACvF,IAAIlC,IAAI,KAAK,SAAS,EAAE2G,IAAI,CAACzE,IAAI,GAAG;MAAEC,KAAK,EAAE,YAAY;MAAEyE,WAAW,EAAE,EAAE;MAAExE,YAAY,EAAE;IAAG,CAAC;IAC9F,IAAIpC,IAAI,KAAK,KAAK,EAAM2G,IAAI,CAACzE,IAAI,GAAG;MAAEC,KAAK,EAAE,UAAU;MAAEI,MAAM,EAAE,KAAK;MAAEsE,GAAG,EAAE,EAAE;MAAEC,OAAO,EAAE,IAAI;MAAEC,IAAI,EAAE;IAAK,CAAC;IAC5G,IAAI/G,IAAI,KAAK,MAAM,EAAK2G,IAAI,CAACzE,IAAI,GAAG;MAAEC,KAAK,EAAE,MAAM;MAAEkB,IAAI,EAAE;IAAyB,CAAC;IACrF,IAAIrD,IAAI,KAAK,UAAU,EAAC2G,IAAI,CAACzE,IAAI,GAAG;MAAEC,KAAK,EAAE,WAAW;MAAEU,OAAO,EAAE,UAAU;MAAEC,IAAI,EAAE,MAAM;MAAEkE,IAAI,EAAE;IAAgB,CAAC;IACpHnD,QAAQ,CAACuB,EAAE,IAAI,CAAC,GAAGA,EAAE,EAAEuB,IAAI,CAAC,CAAC;IAC7BtC,aAAa,CAAClE,EAAE,CAAC;EACnB,CAAC;EAED,MAAM8G,iBAAiB,GAAGA,CAAA,KAAM;IAC9B,IAAI,CAAClC,YAAY,EAAE;IACnB,MAAM5E,EAAE,GAAG,GAAG4E,YAAY,CAAC/E,IAAI,IAAIyG,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IAC/C7C,QAAQ,CAACuB,EAAE,IAAI,CAAC,GAAGA,EAAE,EAAE;MAAE,GAAGL,YAAY;MAAE5E,EAAE;MAAEF,QAAQ,EAAE;QAAE8D,CAAC,EAAEgB,YAAY,CAAC9E,QAAQ,CAAC8D,CAAC,GAAG,EAAE;QAAEC,CAAC,EAAEe,YAAY,CAAC9E,QAAQ,CAAC+D,CAAC,GAAG;MAAG;IAAE,CAAC,CAAC,CAAC;IAChIK,aAAa,CAAClE,EAAE,CAAC;EACnB,CAAC;EAED,MAAM+G,cAAc,GAAGA,CAAA,KAAM;IAC3B,IAAI,CAACnC,YAAY,EAAE;IACnBb,QAAQ,CAAC+B,GAAG,IAAIA,GAAG,CAACkB,MAAM,CAACtB,CAAC,IAAIA,CAAC,CAACJ,MAAM,KAAKV,YAAY,CAAC5E,EAAE,IAAI0F,CAAC,CAACF,MAAM,KAAKZ,YAAY,CAAC5E,EAAE,CAAC,CAAC;IAC9F0D,QAAQ,CAACuB,EAAE,IAAIA,EAAE,CAAC+B,MAAM,CAAClC,CAAC,IAAIA,CAAC,CAAC9E,EAAE,KAAK4E,YAAY,CAAC5E,EAAE,CAAC,CAAC;IACxDkE,aAAa,CAAC,IAAI,CAAC;EACrB,CAAC;;EAED;EACA,MAAM+C,OAAO,GAAGA,CAAA,KAAM;IACpB,IAAI,CAACrC,YAAY,EAAE,oBAAOnF,OAAA;MAAKQ,KAAK,EAAE;QAAEF,KAAK,EAAE;MAAU,CAAE;MAAAiB,QAAA,EAAC;IAAe;MAAAT,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;IACjF,MAAMwG,CAAC,GAAGtC,YAAY,CAAC/E,IAAI;IAC3B,MAAM4E,CAAC,GAAGG,YAAY,CAAC7C,IAAI,IAAI,CAAC,CAAC;IAEjC,MAAMoF,CAAC,GAAGA,CAAC;MAAEnG;IAAS,CAAC,kBAAKvB,OAAA;MAAOQ,KAAK,EAAE;QAAEmH,OAAO,EAAE,OAAO;QAAEC,SAAS,EAAE,EAAE;QAAE/F,QAAQ,EAAE,EAAE;QAAEvB,KAAK,EAAE;MAAU,CAAE;MAAAiB,QAAA,EAAEA;IAAQ;MAAAT,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;IACjI,MAAM4G,EAAE,GAAIC,KAAK,iBAAK9H,OAAA;MAAA,GAAW8H,KAAK;MAAEtH,KAAK,EAAE;QAAEC,KAAK,EAAE,MAAM;QAAEiB,OAAO,EAAE,CAAC;QAAEd,MAAM,EAAE,mBAAmB;QAAEa,YAAY,EAAE;MAAE;IAAE;MAAAX,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;IAC9H,MAAM8G,EAAE,GAAID,KAAK,iBAAK9H,OAAA;MAAA,GAAc8H,KAAK;MAAEtH,KAAK,EAAE;QAAEC,KAAK,EAAE,MAAM;QAAEiB,OAAO,EAAE,CAAC;QAAEd,MAAM,EAAE,mBAAmB;QAAEa,YAAY,EAAE;MAAE;IAAE;MAAAX,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;IACjI,MAAM+G,EAAE,GAAIF,KAAK,iBAAK9H,OAAA;MAAA,GAAY8H,KAAK;MAAEtH,KAAK,EAAE;QAAEC,KAAK,EAAE,MAAM;QAAEiB,OAAO,EAAE,CAAC;QAAEd,MAAM,EAAE,mBAAmB;QAAEa,YAAY,EAAE;MAAE;IAAE;MAAAX,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;IAE/H,IAAIwG,CAAC,KAAK,SAAS,EAAE;MACnB,oBACEzH,OAAA;QAAAuB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACZjB,OAAA,CAAC6H,EAAE;UAACI,KAAK,EAAEjD,CAAC,CAACzC,KAAK,IAAI,EAAG;UAAC2F,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE/C,KAAK,EAAE0D,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACjFjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAe;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACtBjB,OAAA,CAACgI,EAAE;UACDC,KAAK,EAAEjD,CAAC,CAACgC,WAAW,IAAI,EAAG;UAC3BkB,QAAQ,EAAEjC,CAAC,IAAI;YACb,MAAMkC,GAAG,GAAGlC,CAAC,CAACF,MAAM,CAACkC,KAAK;YAC1B,MAAMR,CAAC,GAAG/C,SAAS,CAACU,IAAI,CAACjB,CAAC,IAAIA,CAAC,CAACgE,GAAG,KAAKA,GAAG,CAAC;YAC5C7C,SAAS,CAAC;cAAE0B,WAAW,EAAEmB,GAAG;cAAE3F,YAAY,EAAE,CAAAiF,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEW,aAAa,KAAI;YAAG,CAAC,CAAC;UACvE,CAAE;UAAA7G,QAAA,gBAEFvB,OAAA;YAAQiI,KAAK,EAAC,EAAE;YAAA1G,QAAA,EAAC;UAAa;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACtCyD,SAAS,CAACe,GAAG,CAACgC,CAAC,iBAAIzH,OAAA;YAAoBiI,KAAK,EAAER,CAAC,CAACU,GAAI;YAAA5G,QAAA,EAAEkG,CAAC,CAACW;UAAa,GAArCX,CAAC,CAACU,GAAG;YAAArH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAyC,CAAC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/E,CAAC,EACJ,CAAC,CAAC+D,CAAC,CAACgC,WAAW,iBACdhH,OAAA,CAAAE,SAAA;UAAAqB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;YAAAnG,QAAA,EAAC;UAAO;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eACdjB,OAAA,CAAC+H,EAAE;YAACM,IAAI,EAAE,CAAE;YAACC,QAAQ;YAACL,KAAK,EAAE,CAACM,eAAA,IAAM;cAClC,MAAMd,CAAC,GAAG/C,SAAS,CAACU,IAAI,CAACjB,CAAC,IAAIA,CAAC,CAACgE,GAAG,KAAKnD,CAAC,CAACgC,WAAW,CAAC;cACtD,OAAOS,CAAC,GAAI,EAAAc,eAAA,GAAAC,MAAM,CAACC,MAAM,CAAChB,CAAC,CAACiB,KAAK,CAAC,CAAC,CAAC,CAAC,cAAAH,eAAA,uBAAzBA,eAAA,CAA2BpB,IAAI,KAAI,EAAE,GAAI,EAAE;YACzD,CAAC,EAAE;UAAE;YAAArG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA,eACR,CACH;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAEV;IAEA,IAAIwG,CAAC,KAAK,KAAK,EAAE;MACf,oBACEzH,OAAA;QAAAuB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACZjB,OAAA,CAAC6H,EAAE;UAACI,KAAK,EAAEjD,CAAC,CAACzC,KAAK,IAAI,EAAG;UAAC2F,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE/C,KAAK,EAAE0D,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACjFjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAM;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACbjB,OAAA,CAACgI,EAAE;UAACC,KAAK,EAAEjD,CAAC,CAACrC,MAAM,IAAI,KAAM;UAACuF,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE3C,MAAM,EAAEsD,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC,CAAE;UAAA1G,QAAA,gBACjFvB,OAAA;YAAAuB,QAAA,EAAQ;UAAG;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAAAjB,OAAA;YAAAuB,QAAA,EAAQ;UAAI;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAAAjB,OAAA;YAAAuB,QAAA,EAAQ;UAAG;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAAAjB,OAAA;YAAAuB,QAAA,EAAQ;UAAK;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAAAjB,OAAA;YAAAuB,QAAA,EAAQ;UAAM;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxG,CAAC,eACLjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAG;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACVjB,OAAA,CAAC6H,EAAE;UAACc,WAAW,EAAC,gCAAgC;UAACV,KAAK,EAAEjD,CAAC,CAACiC,GAAG,IAAI,EAAG;UAACiB,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE2B,GAAG,EAAEhB,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC1HjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAc;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACrBjB,OAAA,CAAC+H,EAAE;UAACM,IAAI,EAAE,CAAE;UAACJ,KAAK,EAAEjD,CAAC,CAACkC,OAAO,IAAI,IAAK;UAACgB,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE4B,OAAO,EAAEjB,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAChGjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAW;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAClBjB,OAAA,CAAC+H,EAAE;UAACM,IAAI,EAAE,CAAE;UAACJ,KAAK,EAAEjD,CAAC,CAACmC,IAAI,IAAI,IAAK;UAACe,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE6B,IAAI,EAAElB,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvF,CAAC;IAEV;IAEA,IAAIwG,CAAC,KAAK,MAAM,EAAE;MAChB,oBACEzH,OAAA;QAAAuB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACZjB,OAAA,CAAC6H,EAAE;UAACI,KAAK,EAAEjD,CAAC,CAACzC,KAAK,IAAI,EAAG;UAAC2F,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE/C,KAAK,EAAE0D,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACjFjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAU;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACjBjB,OAAA,CAAC+H,EAAE;UAACM,IAAI,EAAE,EAAG;UAACJ,KAAK,EAAEjD,CAAC,CAACvB,IAAI,IAAI,EAAG;UAACyE,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE7B,IAAI,EAAEwC,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtF,CAAC;IAEV;IAEA,IAAIwG,CAAC,KAAK,UAAU,EAAE;MACpB,MAAMmB,QAAQ,GAAG5D,CAAC,CAACgC,WAAW,GAC1B,CAAC6B,gBAAA,IAAM;QACL,MAAMpB,CAAC,GAAG/C,SAAS,CAACU,IAAI,CAAC0D,EAAE,IAAIA,EAAE,CAACX,GAAG,KAAKnD,CAAC,CAACgC,WAAW,CAAC;QACxD,OAAOS,CAAC,GAAI,EAAAoB,gBAAA,GAAAL,MAAM,CAACC,MAAM,CAAChB,CAAC,CAACiB,KAAK,CAAC,CAAC,CAAC,CAAC,cAAAG,gBAAA,uBAAzBA,gBAAA,CAA2B1B,IAAI,KAAI,EAAE,GAAI,EAAE;MACzD,CAAC,EAAE,CAAC,GACJ,EAAE;MACN,oBACEnH,OAAA;QAAAuB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACZjB,OAAA,CAAC6H,EAAE;UAACI,KAAK,EAAEjD,CAAC,CAACzC,KAAK,IAAI,EAAG;UAAC2F,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAE/C,KAAK,EAAE0D,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC;QAAE;UAAAnH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACjFjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAO;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACdjB,OAAA,CAACgI,EAAE;UAACC,KAAK,EAAEjD,CAAC,CAAC/B,OAAO,IAAI,UAAW;UAACiF,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAErC,OAAO,EAAEgD,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC,CAAE;UAAA1G,QAAA,gBACxFvB,OAAA;YAAQiI,KAAK,EAAC,UAAU;YAAA1G,QAAA,EAAC;UAAQ;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAC1CjB,OAAA;YAAQiI,KAAK,EAAC,KAAK;YAAA1G,QAAA,EAAC;UAAG;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9B,CAAC,eACLjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAI;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACXjB,OAAA,CAACgI,EAAE;UAACC,KAAK,EAAEjD,CAAC,CAAC9B,IAAI,IAAI,MAAO;UAACgF,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;YAAEpC,IAAI,EAAE+C,CAAC,CAACF,MAAM,CAACkC;UAAM,CAAC,CAAE;UAAA1G,QAAA,gBAC9EvB,OAAA;YAAQiI,KAAK,EAAC,MAAM;YAAA1G,QAAA,EAAC;UAAI;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAClCjB,OAAA;YAAQiI,KAAK,EAAC,OAAO;YAAA1G,QAAA,EAAC;UAAK;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACpCjB,OAAA;YAAQiI,KAAK,EAAC,MAAM;YAAA1G,QAAA,EAAC;UAA6B;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzD,CAAC,eACLjB,OAAA,CAAC0H,CAAC;UAAAnG,QAAA,EAAC;QAAiC;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACxCjB,OAAA,CAACgI,EAAE;UACDC,KAAK,EAAEjD,CAAC,CAACgC,WAAW,IAAI,EAAG;UAC3BkB,QAAQ,EAAEjC,CAAC,IAAI;YACb,MAAMkC,GAAG,GAAGlC,CAAC,CAACF,MAAM,CAACkC,KAAK;YAC1B,MAAMR,CAAC,GAAG/C,SAAS,CAACU,IAAI,CAACjB,CAAC,IAAIA,CAAC,CAACgE,GAAG,KAAKA,GAAG,CAAC;YAC5C7C,SAAS,CAAC;cAAE0B,WAAW,EAAEmB,GAAG;cAAE3F,YAAY,EAAE,CAAAiF,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEW,aAAa,KAAI;YAAG,CAAC,CAAC;UACvE,CAAE;UAAA7G,QAAA,gBAEFvB,OAAA;YAAQiI,KAAK,EAAC,EAAE;YAAA1G,QAAA,EAAC;UAAQ;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACjCyD,SAAS,CAACe,GAAG,CAACgC,CAAC,iBAAIzH,OAAA;YAAoBiI,KAAK,EAAER,CAAC,CAACU,GAAI;YAAA5G,QAAA,EAAEkG,CAAC,CAACW;UAAa,GAArCX,CAAC,CAACU,GAAG;YAAArH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAyC,CAAC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/E,CAAC,EACJ,CAAC+D,CAAC,CAAC9B,IAAI,KAAK,MAAM,IAAI8B,CAAC,CAAC9B,IAAI,KAAK,MAAM,kBACtClD,OAAA,CAAAE,SAAA;UAAAqB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;YAAAnG,QAAA,EAAC;UAAI;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eACXjB,OAAA,CAAC+H,EAAE;YAACM,IAAI,EAAE,CAAE;YAACJ,KAAK,EAAEjD,CAAC,CAACoC,IAAI,IAAI,EAAG;YAACc,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;cAAE8B,IAAI,EAAEnB,CAAC,CAACF,MAAM,CAACkC;YAAM,CAAC;UAAE;YAAAnH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA,eACxF,CACH,EACA,CAAC+D,CAAC,CAAC9B,IAAI,KAAK,OAAO,IAAI8B,CAAC,CAAC9B,IAAI,KAAK,MAAM,kBACvClD,OAAA,CAAAE,SAAA;UAAAqB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;YAAAnG,QAAA,EAAC;UAAS;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eAChBjB,OAAA,CAAC6H,EAAE;YAACI,KAAK,EAAEjD,CAAC,CAAC+D,QAAQ,IAAI,EAAG;YAACb,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;cAAEyD,QAAQ,EAAE9C,CAAC,CAACF,MAAM,CAACkC;YAAM,CAAC;UAAE;YAAAnH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA,eACvF,CACH,EACA+D,CAAC,CAACgC,WAAW,IAAI4B,QAAQ,gBACxB5I,OAAA,CAAAE,SAAA;UAAAqB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;YAAAnG,QAAA,EAAC;UAAgB;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eACvBjB,OAAA,CAAC+H,EAAE;YAACM,IAAI,EAAE,CAAE;YAACC,QAAQ;YAACL,KAAK,EAAEW;UAAS;YAAA9H,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA,eACzC,CAAC,GACD,IAAI;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAEV;;IAEA;IACA,oBACEjB,OAAA;MAAAuB,QAAA,gBACEvB,OAAA,CAAC0H,CAAC;QAAAnG,QAAA,EAAC;MAAK;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACZjB,OAAA,CAAC6H,EAAE;QAACI,KAAK,EAAEjD,CAAC,CAACzC,KAAK,IAAI,EAAG;QAAC2F,QAAQ,EAAEjC,CAAC,IAAIX,SAAS,CAAC;UAAE/C,KAAK,EAAE0D,CAAC,CAACF,MAAM,CAACkC;QAAM,CAAC;MAAE;QAAAnH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC9E,CAAC;EAEV,CAAC;EAED,oBACEjB,OAAA;IAAKQ,KAAK,EAAE;MAAEmH,OAAO,EAAE,MAAM;MAAEqB,mBAAmB,EAAE,WAAW;MAAEC,GAAG,EAAE,EAAE;MAAEvI,MAAM,EAAE;IAAsB,CAAE;IAAAa,QAAA,gBACxGvB,OAAA;MAAAuB,QAAA,gBACEvB,OAAA;QAAKQ,KAAK,EAAE;UAAEmH,OAAO,EAAE,MAAM;UAAEsB,GAAG,EAAE,CAAC;UAAErH,YAAY,EAAE;QAAG,CAAE;QAAAL,QAAA,gBACxDvB,OAAA;UAAQkJ,OAAO,EAAEA,CAAA,KAAMtC,OAAO,CAAC,SAAS,CAAE;UAAArF,QAAA,EAAC;QAAS;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC7DjB,OAAA;UAAQkJ,OAAO,EAAEA,CAAA,KAAMtC,OAAO,CAAC,KAAK,CAAE;UAAArF,QAAA,EAAC;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACrDjB,OAAA;UAAQkJ,OAAO,EAAEA,CAAA,KAAMtC,OAAO,CAAC,MAAM,CAAE;UAAArF,QAAA,EAAC;QAAM;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACvDjB,OAAA;UAAQkJ,OAAO,EAAEA,CAAA,KAAMtC,OAAO,CAAC,UAAU,CAAE;UAAArF,QAAA,EAAC;QAAU;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC/DjB,OAAA;UAAQkJ,OAAO,EAAE7B,iBAAkB;UAAA9F,QAAA,EAAC;QAAQ;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACrDjB,OAAA;UAAQkJ,OAAO,EAAE5B,cAAe;UAAA/F,QAAA,EAAC;QAAe;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtD,CAAC,eAENjB,OAAA;QAAKQ,KAAK,EAAE;UAAEE,MAAM,EAAE,qBAAqB;UAAEE,MAAM,EAAE,mBAAmB;UAAEa,YAAY,EAAE;QAAG,CAAE;QAAAF,QAAA,eAC3FvB,OAAA,CAACV,SAAS;UACR0E,KAAK,EAAEA,KAAM;UACbK,KAAK,EAAEA,KAAM;UACbjB,SAAS,EAAEA,SAAU;UACrBc,aAAa,EAAEA,aAAc;UAC7BK,aAAa,EAAEA,aAAc;UAC7B2B,SAAS,EAAEA,SAAU;UACrBI,WAAW,EAAEA,WAAY;UACzBG,iBAAiB,EAAEA,iBAAkB;UACrC0C,OAAO;UACPC,eAAe,EAAE,KAAM;UACvBC,gBAAgB,EAAE,EAAG;UACrBC,kBAAkB,EAAE;YAAElJ,IAAI,EAAE;UAAa,CAAE;UAAAmB,QAAA,gBAE3CvB,OAAA,CAACT,UAAU;YAAC0J,GAAG,EAAE;UAAG;YAAAnI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACvBjB,OAAA,CAACP,OAAO;YAAAqB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACXjB,OAAA,CAACR,QAAQ;YAAAsB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACT,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAENjB,OAAA;MAAKQ,KAAK,EAAE;QAAEI,MAAM,EAAE,mBAAmB;QAAEa,YAAY,EAAE,EAAE;QAAEC,OAAO,EAAE,EAAE;QAAE6H,QAAQ,EAAE,MAAM;QAAE7I,MAAM,EAAE;MAAsB,CAAE;MAAAa,QAAA,gBAC1HvB,OAAA;QAAIQ,KAAK,EAAE;UAAEgJ,MAAM,EAAE;QAAa,CAAE;QAAAjI,QAAA,EAAC;MAAkB;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC5DjB,OAAA,CAACwH,OAAO;QAAA1G,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACXjB,OAAA;QAAKQ,KAAK,EAAE;UAAEoH,SAAS,EAAE,EAAE;UAAEtH,KAAK,EAAE,SAAS;UAAEuB,QAAQ,EAAE;QAAG,CAAE;QAAAN,QAAA,GAAC,yBACtC,eAAAvB,OAAA;UAAAuB,QAAA,EAAG;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,iBAAa,eAAAjB,OAAA;UAAAuB,QAAA,EAAG;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,gCAAsB,eAAAjB,OAAA;UAAAuB,QAAA,EAAG;QAAO;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,KAClG;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC8C,EAAA,CA5PuBD,cAAc;EAAA,QACKlE,aAAa,EAIbD,aAAa;AAAA;AAAA8J,GAAA,GALhC3F,cAAc;AAAA,IAAA5C,EAAA,EAAAY,GAAA,EAAAG,GAAA,EAAAG,GAAA,EAAAK,GAAA,EAAAI,GAAA,EAAAE,GAAA,EAAAI,GAAA,EAAAsG,GAAA;AAAAC,YAAA,CAAAxI,EAAA;AAAAwI,YAAA,CAAA5H,GAAA;AAAA4H,YAAA,CAAAzH,GAAA;AAAAyH,YAAA,CAAAtH,GAAA;AAAAsH,YAAA,CAAAjH,GAAA;AAAAiH,YAAA,CAAA7G,GAAA;AAAA6G,YAAA,CAAA3G,GAAA;AAAA2G,YAAA,CAAAvG,GAAA;AAAAuG,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}