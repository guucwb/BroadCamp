{"ast":null,"code":"var _jsxFileName = \"/Users/gustsantos/Desktop/initucastt/frontend/src/pages/JourneyBuilder.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// frontend/src/pages/JourneyBuilder.jsx\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport ReactFlow, { Background, Controls, MiniMap, addEdge, useEdgesState, useNodesState, MarkerType, Handle, Position } from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport Papa from 'papaparse';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PIN = 14;\n\n// ---------- helpers ----------\nconst uid = p => `${p}_${Date.now()}_${Math.floor(Math.random() * 9999)}`;\nconst slug = s => String(s || '').trim().toLowerCase().replace(/\\s+/g, '_').replace(/[^\\w]/g, '_').replace(/_+/g, '_');\nconst makeDefaultFlow = () => {\n  const audId = uid('aud');\n  return {\n    nodes: [{\n      id: audId,\n      type: 'audience',\n      position: {\n        x: 160,\n        y: 200\n      },\n      data: {\n        headers: [],\n        rows: [],\n        mapping: {},\n        phoneKey: ''\n      },\n      selectable: true\n    }],\n    edges: []\n  };\n};\n\n// ---------- cards / nodes ----------\nconst Card = ({\n  title,\n  subtitle,\n  selected,\n  children\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    background: '#fff',\n    border: selected ? '2px solid #2563eb' : '1px solid #e5e7eb',\n    borderRadius: 12,\n    width: 340,\n    boxShadow: '0 2px 8px rgba(0,0,0,.06)'\n  },\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '12px 14px',\n      borderBottom: '1px solid #f1f5f9'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontWeight: 800,\n        color: '#0f172a'\n      },\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), subtitle ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 12,\n        color: '#64748b'\n      },\n      children: subtitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 19\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 12\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 47,\n  columnNumber: 3\n}, this);\n_c = Card;\nconst EndNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: \"End\",\n  subtitle: \"t\\xE9rmino do fluxo\",\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"N\\xF3 terminal. S\\xF3 recebe conex\\xF5es.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"target\",\n    position: Position.Left,\n    id: \"in\",\n    style: {\n      background: '#6b7280',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 65,\n  columnNumber: 3\n}, this);\n_c2 = EndNode;\nconst MessageNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: data.label || 'Mensagem',\n  subtitle: `Canal: ${String(data.channel || 'whatsapp').toUpperCase()} • Tipo: ${data.mode || 'text'}`,\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"Conte\\xFAdo configur\\xE1vel no painel ao lado.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"target\",\n    position: Position.Left,\n    id: \"in\",\n    style: {\n      background: '#6b7280',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"source\",\n    position: Position.Right,\n    id: \"out\",\n    style: {\n      background: '#16a34a',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 73,\n  columnNumber: 3\n}, this);\n_c3 = MessageNode;\nconst ApiNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: \"API Call\",\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"Configure m\\xE9todo/URL no painel ao lado. Salva vari\\xE1veis via mapeamentos.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"target\",\n    position: Position.Left,\n    id: \"in\",\n    style: {\n      background: '#6b7280',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"source\",\n    position: Position.Right,\n    id: \"out\",\n    style: {\n      background: '#16a34a',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 87,\n  columnNumber: 3\n}, this);\n_c4 = ApiNode;\nconst CodeNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: \"Code\",\n  subtitle: \"JS custom\",\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"Cole seu JS no painel ao lado. Deve retornar um objeto de vari\\xE1veis.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"target\",\n    position: Position.Left,\n    id: \"in\",\n    style: {\n      background: '#6b7280',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"source\",\n    position: Position.Right,\n    id: \"out\",\n    style: {\n      background: '#16a34a',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 99,\n  columnNumber: 3\n}, this);\n_c5 = CodeNode;\nconst AudienceNode = ({\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: \"Audi\\xEAncia\",\n  subtitle: \"CSV \\u2192 vari\\xE1veis\",\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"Fa\\xE7a upload e mapeie colunas no painel (drawer) ao lado.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"source\",\n    position: Position.Right,\n    id: \"out\",\n    style: {\n      background: '#16a34a',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 111,\n  columnNumber: 3\n}, this);\n_c6 = AudienceNode;\nconst DelayNode = ({\n  data,\n  selected\n}) => /*#__PURE__*/_jsxDEV(Card, {\n  title: \"Delay\",\n  subtitle: data.mode === 'until' ? `até ${data.until || '—'}` : `${data.amount || 0} ${data.unit || 'seconds'}`,\n  selected: selected,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 12,\n      color: '#475569'\n    },\n    children: \"Espera antes de seguir para o pr\\xF3ximo n\\xF3.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"target\",\n    position: Position.Left,\n    id: \"in\",\n    style: {\n      background: '#6b7280',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Handle, {\n    type: \"source\",\n    position: Position.Right,\n    id: \"out\",\n    style: {\n      background: '#16a34a',\n      width: PIN,\n      height: PIN,\n      border: '2px solid #fff'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 121,\n  columnNumber: 3\n}, this);\n\n// ---------- Panels ----------\n_c7 = DelayNode;\nfunction AudiencePanel({\n  node,\n  patchNode,\n  inputStyle,\n  label,\n  slugFn\n}) {\n  _s();\n  const d = node.data || {};\n  const [headers, setHeaders] = useState(d.headers || []);\n  const [rows, setRows] = useState(d.rows || []);\n  const [mapping, setMapping] = useState(d.mapping || {});\n  const [phoneKey, setPhoneKey] = useState(d.phoneKey || '');\n  useEffect(() => {\n    setHeaders(d.headers || []);\n    setRows(d.rows || []);\n    setMapping(d.mapping || {});\n    setPhoneKey(d.phoneKey || '');\n  }, [node.id]);\n  const onFile = e => {\n    var _e$target$files;\n    const f = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!f) return;\n    Papa.parse(f, {\n      header: true,\n      skipEmptyLines: true,\n      complete: res => {\n        const hs = res.meta.fields || Object.keys(res.data[0] || {});\n        const guess = {};\n        hs.forEach(h => guess[h] = slugFn(h));\n        const pk = hs.find(h => /phone|telefone|celular|numero|n[uú]mero/i.test(h)) || '';\n        setHeaders(hs);\n        setRows(res.data.slice(0, 5));\n        setMapping(guess);\n        setPhoneKey(pk);\n      }\n    });\n  };\n  const saveMap = () => {\n    if (!phoneKey) {\n      alert('Escolha a coluna de telefone.');\n      return;\n    }\n    patchNode(node.id, {\n      headers,\n      rows,\n      mapping,\n      phoneKey\n    });\n    alert('Mapeamento salvo.');\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [label('Arquivo CSV'), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \".csv\",\n      onChange: onFile\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this), headers.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [label('Coluna de telefone'), /*#__PURE__*/_jsxDEV(\"select\", {\n        style: inputStyle,\n        value: phoneKey,\n        onChange: e => setPhoneKey(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"\\u2014 selecione \\u2014\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }, this), headers.map(h => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: h,\n          children: h\n        }, h, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 34\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }, this), label('Mapeamento (coluna → variável)'), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: '1fr 20px 1fr',\n          gap: 8,\n          maxHeight: 200,\n          overflow: 'auto'\n        },\n        children: headers.map(h => /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              alignSelf: 'center',\n              fontSize: 13\n            },\n            children: h\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center',\n              color: '#94a3b8'\n            },\n            children: \"\\u2192\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            style: inputStyle,\n            value: mapping[h] || '',\n            placeholder: slugFn(h),\n            onChange: e => setMapping(m => ({\n              ...m,\n              [h]: slugFn(e.target.value)\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 17\n          }, this)]\n        }, h, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: saveMap,\n        style: {\n          marginTop: 10\n        },\n        children: \"Salvar mapeamento\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }, this), rows.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [label('Amostra (5 primeiras linhas)'), /*#__PURE__*/_jsxDEV(\"pre\", {\n          style: {\n            background: '#f8fafc',\n            border: '1px solid #e2e8f0',\n            borderRadius: 8,\n            padding: 10,\n            fontSize: 12,\n            maxHeight: 160,\n            overflow: 'auto'\n          },\n          children: JSON.stringify(rows, null, 2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true)]\n  }, void 0, true);\n}\n\n// ---------- main ----------\n_s(AudiencePanel, \"Gvd8UhRxqXlUdrrpexXFfFXUeMs=\");\n_c8 = AudiencePanel;\nexport default function JourneyBuilder() {\n  _s2();\n  const def = makeDefaultFlow();\n  const [nodes, setNodes, baseOnNodesChange] = useNodesState(def.nodes);\n  const [edges, setEdges, baseOnEdgesChange] = useEdgesState(def.edges);\n  const [rf, setRf] = useState(null);\n  const [selectedId, setSelectedId] = useState(null);\n  const selectedNode = useMemo(() => nodes.find(n => n.id === selectedId), [nodes, selectedId]);\n  const [flowId, setFlowId] = useState(null);\n  const [flowName, setFlowName] = useState('Novo Flow');\n  const [dirty, setDirty] = useState(false);\n\n  // templates Twilio\n  const [templates, setTemplates] = useState([]);\n  useEffect(() => {\n    fetch('/api/templates/list').then(r => r.json()).then(data => setTemplates(data.contents || [])).catch(() => setTemplates([]));\n  }, []);\n\n  // carregar por ?id= (ou default com apenas Audiência)\n  useEffect(() => {\n    const sp = new URLSearchParams(window.location.search);\n    const id = sp.get('id');\n    if (!id) {\n      const base = makeDefaultFlow();\n      setNodes(base.nodes);\n      setEdges(base.edges);\n      return;\n    }\n    setFlowId(id);\n    fetch(`/api/journeys/${id}`).then(r => r.ok ? r.json() : Promise.reject()).then(f => {\n      if (Array.isArray(f.nodes) && Array.isArray(f.edges) && f.nodes.length) {\n        setNodes(f.nodes);\n        setEdges(f.edges);\n        if (f.name) setFlowName(f.name);\n      } else {\n        const base = makeDefaultFlow();\n        setNodes(base.nodes);\n        setEdges(base.edges);\n      }\n    }).catch(() => {\n      const raw = localStorage.getItem(id);\n      if (raw) {\n        try {\n          const f = JSON.parse(raw);\n          if (Array.isArray(f.nodes) && Array.isArray(f.edges) && f.nodes.length) {\n            setNodes(f.nodes);\n            setEdges(f.edges);\n            if (f.name) setFlowName(f.name);\n            return;\n          }\n        } catch {}\n      }\n      const base = makeDefaultFlow();\n      setNodes(base.nodes);\n      setEdges(base.edges);\n    });\n  }, [setNodes, setEdges]);\n\n  // fit agradável quando há nós\n  useEffect(() => {\n    if (!rf || nodes.length === 0) return;\n    requestAnimationFrame(() => {\n      try {\n        rf.fitView({\n          padding: 0.2,\n          includeHiddenNodes: false\n        });\n        const vp = rf.getViewport();\n        if ((vp === null || vp === void 0 ? void 0 : vp.zoom) > 1.1) rf.setViewport({\n          x: vp.x,\n          y: vp.y,\n          zoom: 0.9\n        });\n        if ((vp === null || vp === void 0 ? void 0 : vp.zoom) < 0.3) rf.setViewport({\n          x: vp.x,\n          y: vp.y,\n          zoom: 0.5\n        });\n      } catch {}\n    });\n  }, [rf, nodes]);\n\n  // wrappers que marcam dirty\n  const onNodesChange = useCallback(changes => {\n    setDirty(true);\n    baseOnNodesChange(changes);\n  }, [baseOnNodesChange]);\n  const onEdgesChange = useCallback(changes => {\n    setDirty(true);\n    baseOnEdgesChange(changes);\n  }, [baseOnEdgesChange]);\n  const patchNode = useCallback((id, patch) => {\n    setDirty(true);\n    setNodes(nds => nds.map(n => n.id === id ? {\n      ...n,\n      data: {\n        ...n.data,\n        ...patch\n      }\n    } : n));\n  }, [setNodes]);\n\n  // 1 saída por nó\n  const onConnect = useCallback(params => {\n    setDirty(true);\n    setEdges(eds => {\n      const filtered = eds.filter(e => e.source !== params.source);\n      return addEdge({\n        ...params,\n        type: 'smoothstep',\n        style: {\n          stroke: '#0f172a'\n        },\n        markerEnd: {\n          type: MarkerType.ArrowClosed,\n          color: '#0f172a'\n        }\n      }, filtered);\n    });\n  }, [setEdges]);\n  const onSelectionChange = useCallback(({\n    nodes: ns\n  }) => {\n    var _ns$0$id, _ns$;\n    setSelectedId((_ns$0$id = ns === null || ns === void 0 ? void 0 : (_ns$ = ns[0]) === null || _ns$ === void 0 ? void 0 : _ns$.id) !== null && _ns$0$id !== void 0 ? _ns$0$id : null);\n  }, []);\n\n  // drag & drop\n  const onDragStart = (e, type) => {\n    e.dataTransfer.setData('application/x-node-type', type);\n    e.dataTransfer.effectAllowed = 'move';\n  };\n  const createNodeByType = (type, position) => {\n    const id = uid(type);\n    if (type === 'message') return {\n      id,\n      type: 'message',\n      position,\n      data: {\n        label: 'Mensagem',\n        channel: 'whatsapp',\n        mode: 'text',\n        text: ''\n      }\n    };\n    if (type === 'api') return {\n      id,\n      type: 'api',\n      position,\n      data: {\n        label: 'API Call',\n        method: 'GET',\n        url: '',\n        headers: '{}',\n        body: '{}',\n        mappings: [],\n        lastResponse: ''\n      }\n    };\n    if (type === 'code') return {\n      id,\n      type: 'code',\n      position,\n      data: {\n        label: 'Code',\n        code: '// return { nova_variavel: 123 };'\n      }\n    };\n    if (type === 'audience') return {\n      id,\n      type: 'audience',\n      position,\n      data: {\n        headers: [],\n        rows: [],\n        mapping: {},\n        phoneKey: ''\n      }\n    };\n    if (type === 'delay') return {\n      id,\n      type: 'delay',\n      position,\n      data: {\n        mode: 'duration',\n        amount: 30,\n        unit: 'seconds',\n        until: ''\n      }\n    };\n    if (type === 'end') return {\n      id,\n      type: 'end',\n      position,\n      data: {}\n    };\n    return null;\n  };\n  const onDrop = useCallback(e => {\n    e.preventDefault();\n    const type = e.dataTransfer.getData('application/x-node-type');\n    if (!rf || !type) return;\n    const pos = rf.project({\n      x: e.clientX,\n      y: e.clientY\n    });\n    const node = createNodeByType(type, pos);\n    if (!node) return;\n    setNodes(nds => nds.concat(node));\n    setDirty(true);\n  }, [rf, setNodes]);\n  const onDragOver = useCallback(e => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  // context menu\n  const [ctxMenu, setCtxMenu] = useState(null);\n  const onNodeContextMenu = (evt, node) => {\n    evt.preventDefault();\n    setCtxMenu({\n      x: evt.clientX,\n      y: evt.clientY,\n      id: node.id\n    });\n  };\n  const ctxClose = () => setCtxMenu(null);\n  const ctxDelete = () => {\n    if (!ctxMenu) return;\n    const id = ctxMenu.id;\n    setEdges(eds => eds.filter(e => e.source !== id && e.target !== id));\n    setNodes(nds => nds.filter(n => n.id !== id));\n    setSelectedId(null);\n    setDirty(true);\n    ctxClose();\n  };\n  const ctxDuplicate = () => {\n    if (!ctxMenu) return;\n    const n = nodes.find(x => x.id === ctxMenu.id);\n    if (!n) return;\n    const copy = {\n      ...n,\n      id: uid(n.type),\n      position: {\n        x: n.position.x + 40,\n        y: n.position.y + 40\n      }\n    };\n    setNodes(nds => nds.concat(copy));\n    setDirty(true);\n    ctxClose();\n  };\n  const ctxRename = () => {\n    var _n$data;\n    if (!ctxMenu) return;\n    const n = nodes.find(x => x.id === ctxMenu.id);\n    if (!n) return;\n    const val = prompt('Novo nome/label do nó:', ((_n$data = n.data) === null || _n$data === void 0 ? void 0 : _n$data.label) || '');\n    if (val != null) patchNode(n.id, {\n      label: val\n    });\n    ctxClose();\n  };\n  const ctxReset = () => {\n    if (!ctxMenu) return;\n    const n = nodes.find(x => x.id === ctxMenu.id);\n    if (!n) return;\n    const fresh = createNodeByType(n.type, n.position);\n    if (fresh) patchNode(n.id, fresh.data || {});\n    ctxClose();\n  };\n\n  // auto-layout simples\n  const autoLayout = () => {\n    const root = nodes.find(n => n.type === 'audience') || nodes[0];\n    if (!root) return;\n    const children = nid => edges.filter(e => e.source === nid).map(e => e.target);\n    const visited = new Set();\n    const levels = {};\n    const q = [{\n      id: root.id,\n      d: 0\n    }];\n    while (q.length) {\n      var _levels$id;\n      const {\n        id,\n        d\n      } = q.shift();\n      if (visited.has(id)) continue;\n      visited.add(id);\n      levels[id] = Math.min((_levels$id = levels[id]) !== null && _levels$id !== void 0 ? _levels$id : Infinity, d);\n      children(id).forEach(t => q.push({\n        id: t,\n        d: d + 1\n      }));\n    }\n    const byLevel = {};\n    Object.entries(levels).forEach(([id, lv]) => {\n      byLevel[lv] = byLevel[lv] || [];\n      byLevel[lv].push(id);\n    });\n    const X0 = 160,\n      XG = 420,\n      Y0 = 160,\n      YG = 180;\n    const newPos = {};\n    Object.keys(byLevel).map(Number).sort((a, b) => a - b).forEach(lv => {\n      byLevel[lv].forEach((id, i) => newPos[id] = {\n        x: X0 + lv * XG,\n        y: Y0 + i * YG\n      });\n    });\n    setNodes(nds => nds.map(n => newPos[n.id] ? {\n      ...n,\n      position: newPos[n.id]\n    } : n));\n    setDirty(true);\n  };\n\n  // salvar – adiciona um único End (se não existir) e conecta todos os \"sinks\"\n  const ensureEndForPayload = (nodesIn, edgesIn) => {\n    const hasEnd = nodesIn.some(n => n.type === 'end');\n    if (hasEnd) return {\n      nodesOut: nodesIn,\n      edgesOut: edgesIn\n    };\n    const outBy = {};\n    edgesIn.forEach(e => {\n      outBy[e.source] = true;\n    });\n    const sinks = nodesIn.filter(n => n.type !== 'end' && !outBy[n.id]);\n\n    // posição do End: à direita do mais “à direita”\n    const maxX = Math.max(...nodesIn.map(n => n.position.x));\n    const avgY = sinks.length ? sinks.reduce((a, n) => a + n.position.y, 0) / sinks.length : 200;\n    const endNode = {\n      id: uid('end'),\n      type: 'end',\n      position: {\n        x: maxX + 420,\n        y: avgY\n      },\n      data: {}\n    };\n    const newEdges = edgesIn.slice();\n    sinks.forEach(s => {\n      newEdges.push({\n        id: uid('e'),\n        source: s.id,\n        target: endNode.id,\n        sourceHandle: 'out',\n        targetHandle: 'in',\n        type: 'smoothstep',\n        markerEnd: {\n          type: MarkerType.ArrowClosed,\n          color: '#0f172a'\n        },\n        style: {\n          stroke: '#0f172a'\n        }\n      });\n    });\n    return {\n      nodesOut: nodesIn.concat(endNode),\n      edgesOut: newEdges\n    };\n  };\n  const saveFlow = async () => {\n    // monta payload (com End auto)\n    const {\n      nodesOut,\n      edgesOut\n    } = ensureEndForPayload(nodes, edges);\n    const id = flowId || 'flow_' + Date.now();\n    const payload = {\n      id,\n      name: flowName || 'Sem nome',\n      nodes: nodesOut,\n      edges: edgesOut,\n      updatedAt: new Date().toISOString()\n    };\n    try {\n      const url = flowId ? `/api/journeys/${flowId}` : '/api/journeys';\n      const method = flowId ? 'PUT' : 'POST';\n      const res = await fetch(url, {\n        method,\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) throw new Error('no backend');\n      const saved = await res.json();\n      alert('Flow salvo no backend!');\n      // reflete o End no canvas e marca como não sujo\n      setNodes(nodesOut);\n      setEdges(edgesOut);\n      setDirty(false);\n      if (!flowId && saved !== null && saved !== void 0 && saved.id) {\n        setFlowId(saved.id);\n        const u = new URL(window.location.href);\n        u.searchParams.set('id', saved.id);\n        window.history.replaceState(null, '', u.toString());\n      }\n    } catch {\n      localStorage.setItem(id, JSON.stringify(payload));\n      alert('Flow salvo no navegador.');\n      setNodes(nodesOut);\n      setEdges(edgesOut);\n      setDirty(false);\n      if (!flowId) {\n        setFlowId(id);\n        const u = new URL(window.location.href);\n        u.searchParams.set('id', id);\n        window.history.replaceState(null, '', u.toString());\n      }\n    }\n  };\n  const exportFlow = () => {\n    const blob = new Blob([JSON.stringify({\n      id: flowId || 'temp',\n      name: flowName,\n      nodes,\n      edges\n    }, null, 2)], {\n      type: 'application/json'\n    });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `${slug(flowName || 'flow')}.json`;\n    a.click();\n  };\n  const importFlow = async e => {\n    var _e$target$files2;\n    const f = (_e$target$files2 = e.target.files) === null || _e$target$files2 === void 0 ? void 0 : _e$target$files2[0];\n    if (!f) return;\n    const txt = await f.text();\n    try {\n      const j = JSON.parse(txt);\n      if (Array.isArray(j.nodes) && Array.isArray(j.edges)) {\n        setNodes(j.nodes);\n        setEdges(j.edges);\n        if (j.name) setFlowName(j.name);\n        if (j.id) {\n          setFlowId(j.id);\n          const u = new URL(window.location.href);\n          u.searchParams.set('id', j.id);\n          window.history.replaceState(null, '', u.toString());\n        }\n        setDirty(true);\n      } else alert('Arquivo inválido.');\n    } catch {\n      alert('JSON inválido.');\n    } finally {\n      e.target.value = '';\n    }\n  };\n\n  // node types\n  const nodeTypes = useMemo(() => ({\n    end: EndNode,\n    message: MessageNode,\n    api: ApiNode,\n    code: CodeNode,\n    audience: AudienceNode,\n    delay: DelayNode\n  }), []);\n\n  // Drawer (aparece só quando há nó selecionado)\n  const inputStyle = {\n    width: '100%',\n    border: '1px solid #cbd5e1',\n    borderRadius: 8,\n    padding: '10px 12px'\n  };\n  const small = {\n    fontSize: 12,\n    color: '#475569',\n    marginBottom: 6\n  };\n  const label = t => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: small,\n    children: t\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 545,\n    columnNumber: 24\n  }, this);\n  const TemplatesOptions = ({\n    value,\n    onChange\n  }) => /*#__PURE__*/_jsxDEV(\"select\", {\n    value: value || '',\n    onChange: e => onChange(e.target.value),\n    style: inputStyle,\n    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n      value: \"\",\n      children: \"\\u2014 none \\u2014\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 7\n    }, this), templates.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n      value: t.sid,\n      children: t.friendly_name || t.sid\n    }, t.sid, false, {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 30\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 548,\n    columnNumber: 5\n  }, this);\n  const Drawer = () => {\n    const open = !!selectedNode;\n    const wrap = {\n      position: 'fixed',\n      top: 64,\n      right: 16,\n      width: 360,\n      height: 'calc(100vh - 80px)',\n      background: '#fff',\n      border: '1px solid #e5e7eb',\n      borderRadius: 12,\n      boxShadow: '0 12px 24px rgba(0,0,0,.08)',\n      transform: `translateX(${open ? 0 : 420}px)`,\n      transition: 'transform .25s ease',\n      padding: 16,\n      zIndex: 50,\n      overflow: 'auto'\n    };\n    if (!selectedNode) return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: wrap,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: '#94a3b8'\n        },\n        children: \"Selecione um n\\xF3.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 49\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 563,\n      columnNumber: 31\n    }, this);\n    const n = selectedNode;\n\n    // MESSAGE\n    if (n.type === 'message') {\n      var _Object$values$;\n      const d = n.data || {};\n      const found = d.templateSid ? templates.find(t => t.sid === d.templateSid) : null;\n      const firstTypeBody = found ? ((_Object$values$ = Object.values(found.types || {})[0]) === null || _Object$values$ === void 0 ? void 0 : _Object$values$.body) || '' : '';\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: wrap,\n        children: [label('Label'), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: inputStyle,\n          value: d.label || '',\n          onChange: e => patchNode(n.id, {\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 11\n        }, this), label('Canal'), /*#__PURE__*/_jsxDEV(\"select\", {\n          style: inputStyle,\n          value: d.channel || 'whatsapp',\n          onChange: e => patchNode(n.id, {\n            channel: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"whatsapp\",\n            children: \"WhatsApp\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 577,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"sms\",\n            children: \"SMS\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 577,\n            columnNumber: 55\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 11\n        }, this), label('Mode'), /*#__PURE__*/_jsxDEV(\"select\", {\n          style: inputStyle,\n          value: d.mode || 'text',\n          onChange: e => patchNode(n.id, {\n            mode: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"text\",\n            children: \"Text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"rich\",\n            children: \"Rich (text + image + buttons)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 47\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 11\n        }, this), label('Pick a Twilio template (optional)'), /*#__PURE__*/_jsxDEV(TemplatesOptions, {\n          value: d.templateSid,\n          onChange: val => patchNode(n.id, {\n            templateSid: val\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 11\n        }, this), found && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: small,\n            children: \"Template preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            readOnly: true,\n            rows: 6,\n            style: {\n              ...inputStyle,\n              fontFamily: 'monospace'\n            },\n            value: firstTypeBody\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 65\n          }, this)]\n        }, void 0, true), label('Text'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: 8,\n          style: inputStyle,\n          value: d.text || '',\n          onChange: e => patchNode(n.id, {\n            text: e.target.value\n          }),\n          placeholder: \"Ol\\xE1 {{nome}}!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 587,\n          columnNumber: 11\n        }, this), d.mode === 'rich' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [label('Media URL'), /*#__PURE__*/_jsxDEV(\"input\", {\n            style: inputStyle,\n            value: d.mediaUrl || '',\n            onChange: e => patchNode(n.id, {\n              mediaUrl: e.target.value\n            }),\n            placeholder: \"https://...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 591,\n            columnNumber: 15\n          }, this), label('Buttons (JSON opcional)'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            rows: 6,\n            style: inputStyle,\n            value: d.buttonsJson || '',\n            onChange: e => patchNode(n.id, {\n              buttonsJson: e.target.value\n            }),\n            placeholder: \"[{\\\"type\\\":\\\"reply\\\",\\\"title\\\":\\\"Sim\\\",\\\"id\\\":\\\"YES\\\"}]\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 572,\n        columnNumber: 9\n      }, this);\n    }\n\n    // API\n    if (n.type === 'api') {\n      const d = n.data || {};\n      const tryParse = txt => {\n        try {\n          return JSON.stringify(JSON.parse(txt), null, 2);\n        } catch {\n          return txt;\n        }\n      };\n      const testRequest = async () => {\n        try {\n          const headers = d.headers ? JSON.parse(d.headers) : {};\n          const body = d.method === 'GET' || d.method === 'DELETE' ? undefined : d.body && d.body.trim() !== '{}' ? JSON.parse(d.body) : undefined;\n          const res = await fetch(d.url, {\n            method: d.method || 'GET',\n            headers,\n            body: body ? JSON.stringify(body) : undefined\n          });\n          const text = await res.text();\n          patchNode(n.id, {\n            lastResponse: text\n          });\n          alert('Request executada. Veja a resposta abaixo.');\n        } catch (e) {\n          alert('Falha ao executar request: ' + e.message);\n        }\n      };\n      const addMapping = () => {\n        const m = Array.isArray(d.mappings) ? d.mappings.slice() : [];\n        m.push({\n          path: '',\n          var: ''\n        });\n        patchNode(n.id, {\n          mappings: m\n        });\n      };\n      const updateMap = (idx, patch) => {\n        const m = (d.mappings || []).slice();\n        m[idx] = {\n          ...m[idx],\n          ...patch\n        };\n        patchNode(n.id, {\n          mappings: m\n        });\n      };\n      const removeMap = idx => {\n        const m = (d.mappings || []).slice();\n        m.splice(idx, 1);\n        patchNode(n.id, {\n          mappings: m\n        });\n      };\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: wrap,\n        children: [label('Label'), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: inputStyle,\n          value: d.label || 'API Call',\n          onChange: e => patchNode(n.id, {\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 620,\n          columnNumber: 11\n        }, this), label('Método'), /*#__PURE__*/_jsxDEV(\"select\", {\n          style: inputStyle,\n          value: d.method || 'GET',\n          onChange: e => patchNode(n.id, {\n            method: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"GET\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"POST\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"PUT\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 54\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"PATCH\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 74\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"DELETE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 96\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 622,\n          columnNumber: 11\n        }, this), label('URL'), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: inputStyle,\n          placeholder: \"https://api.meuservico.com/...\",\n          value: d.url || '',\n          onChange: e => patchNode(n.id, {\n            url: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 11\n        }, this), label('Headers (JSON)'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: 4,\n          style: inputStyle,\n          value: d.headers || '{}',\n          onChange: e => patchNode(n.id, {\n            headers: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 628,\n          columnNumber: 11\n        }, this), (d.method === 'POST' || d.method === 'PUT' || d.method === 'PATCH') && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [label('Body (JSON)'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            rows: 6,\n            style: inputStyle,\n            value: d.body || '{}',\n            onChange: e => patchNode(n.id, {\n              body: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 631,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: testRequest,\n          style: {\n            marginTop: 10\n          },\n          children: \"Executar request\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 633,\n          columnNumber: 11\n        }, this), label('Resposta (último teste)'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: 8,\n          style: {\n            ...inputStyle,\n            fontFamily: 'monospace'\n          },\n          readOnly: true,\n          value: tryParse(d.lastResponse || '')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 635,\n          columnNumber: 11\n        }, this), label('Mapeamentos JSON → Variáveis'), (d.mappings || []).map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'grid',\n            gridTemplateColumns: '1fr 1fr auto',\n            gap: 8,\n            marginBottom: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            style: inputStyle,\n            placeholder: \"ex.: data.user.id\",\n            value: m.path,\n            onChange: e => updateMap(i, {\n              path: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            style: inputStyle,\n            placeholder: \"ex.: user_id\",\n            value: m.var,\n            onChange: e => updateMap(i, {\n              var: slug(e.target.value)\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn danger\",\n            onClick: () => removeMap(i),\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 15\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: addMapping,\n          children: \"+ adicionar mapeamento\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 618,\n        columnNumber: 9\n      }, this);\n    }\n\n    // CODE\n    if (n.type === 'code') {\n      const d = n.data || {};\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: wrap,\n        children: [label('Label'), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: inputStyle,\n          value: d.label || 'Code',\n          onChange: e => patchNode(n.id, {\n            label: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 11\n        }, this), label('JavaScript'), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: 14,\n          style: {\n            ...inputStyle,\n            fontFamily: 'monospace'\n          },\n          value: d.code || '',\n          onChange: e => patchNode(n.id, {\n            code: e.target.value\n          }),\n          placeholder: `// Recebe \"context\" (variáveis atuais)\\n// deve retornar um objeto com novas variáveis\\nreturn { nova_variavel: 123 };`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 653,\n        columnNumber: 9\n      }, this);\n    }\n\n    // AUDIENCE\n    if (n.type === 'audience') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: wrap,\n        children: /*#__PURE__*/_jsxDEV(AudiencePanel, {\n          node: n,\n          patchNode: patchNode,\n          inputStyle: inputStyle,\n          label: label,\n          slugFn: slug\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 668,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 667,\n        columnNumber: 9\n      }, this);\n    }\n\n    // DELAY\n    if (n.type === 'delay') {\n      var _d$amount;\n      const d = n.data || {};\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: wrap,\n        children: [label('Modo'), /*#__PURE__*/_jsxDEV(\"select\", {\n          style: inputStyle,\n          value: d.mode || 'duration',\n          onChange: e => patchNode(n.id, {\n            mode: e.target.value\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"duration\",\n            children: \"Por dura\\xE7\\xE3o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"until\",\n            children: \"At\\xE9 data/hora\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 11\n        }, this), d.mode === 'duration' ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [label('Quantidade'), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: 0,\n            style: inputStyle,\n            value: (_d$amount = d.amount) !== null && _d$amount !== void 0 ? _d$amount : 0,\n            onChange: e => patchNode(n.id, {\n              amount: Number(e.target.value)\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 686,\n            columnNumber: 15\n          }, this), label('Unidade'), /*#__PURE__*/_jsxDEV(\"select\", {\n            style: inputStyle,\n            value: d.unit || 'seconds',\n            onChange: e => patchNode(n.id, {\n              unit: e.target.value\n            }),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"seconds\",\n              children: \"seconds\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 690,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"minutes\",\n              children: \"minutes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 690,\n              columnNumber: 57\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"hours\",\n              children: \"hours\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 691,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"days\",\n              children: \"days\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 691,\n              columnNumber: 53\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"weeks\",\n              children: \"weeks\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 692,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"months\",\n              children: \"months\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 692,\n              columnNumber: 53\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 689,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [label('Executar após (data/hora)'), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"datetime-local\",\n            style: inputStyle,\n            value: d.until || '',\n            onChange: e => patchNode(n.id, {\n              until: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 698,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 677,\n        columnNumber: 9\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: wrap,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: '#64748b'\n        },\n        children: \"Este n\\xF3 n\\xE3o possui propriedades.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 705,\n        columnNumber: 30\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 705,\n      columnNumber: 12\n    }, this);\n  };\n\n  // UI\n  const chip = {\n    display: 'inline-block',\n    background: '#eef2ff',\n    color: '#1e3a8a',\n    border: '1px solid #c7d2fe',\n    borderRadius: 24,\n    padding: '6px 12px',\n    fontSize: 13,\n    fontWeight: 700,\n    cursor: 'grab',\n    userSelect: 'none'\n  };\n\n  // botão Voltar com confirmação de salvar\n  const goBack = async () => {\n    if (dirty) {\n      const wantSave = window.confirm('Você deseja salvar o fluxo antes de sair?');\n      if (wantSave) {\n        await saveFlow();\n      }\n    }\n    window.location.href = '/journeys';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '100vh',\n      display: 'grid',\n      gridTemplateRows: '56px 1fr'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        gap: 8,\n        padding: '10px 12px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: goBack,\n        children: \"\\u2190 Voltar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 730,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: 12,\n          color: '#4b5563',\n          fontSize: 13\n        },\n        children: \"Arraste para o canvas:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 732,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => onDragStart(e, 'message'),\n        style: chip,\n        title: \"Mensagem\",\n        children: \"Mensagem\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 733,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => onDragStart(e, 'api'),\n        style: chip,\n        title: \"API\",\n        children: \"API\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 734,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => onDragStart(e, 'code'),\n        style: chip,\n        title: \"Code\",\n        children: \"Code\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 735,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => onDragStart(e, 'audience'),\n        style: chip,\n        title: \"Audi\\xEAncia\",\n        children: \"Audi\\xEAncia\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 736,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => onDragStart(e, 'delay'),\n        style: chip,\n        title: \"Delay\",\n        children: \"Delay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 737,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        value: flowName,\n        onChange: e => {\n          setFlowName(e.target.value);\n          setDirty(true);\n        },\n        placeholder: \"Nome do flow\",\n        style: {\n          marginLeft: 16,\n          border: '1px solid #e5e7eb',\n          borderRadius: 8,\n          padding: '8px 12px',\n          minWidth: 220\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 740,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        style: {\n          marginLeft: 'auto'\n        },\n        onClick: autoLayout,\n        children: \"Auto-layout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 744,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"btn secondary\",\n        style: {\n          cursor: 'pointer'\n        },\n        children: [\"Importar\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"application/json\",\n          onChange: importFlow,\n          style: {\n            display: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 746,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn secondary\",\n        onClick: exportFlow,\n        children: \"Exportar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: saveFlow,\n        children: \"Salvar flow\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 751,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 729,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(ReactFlow, {\n        nodes: nodes,\n        edges: edges,\n        nodeTypes: nodeTypes,\n        onNodesChange: onNodesChange,\n        onEdgesChange: onEdgesChange,\n        onConnect: onConnect,\n        onSelectionChange: onSelectionChange,\n        onNodeContextMenu: onNodeContextMenu,\n        onInit: setRf,\n        onDrop: onDrop,\n        onDragOver: onDragOver,\n        minZoom: 0.2,\n        maxZoom: 1.5,\n        defaultViewport: {\n          x: 0,\n          y: 0,\n          zoom: 0.9\n        },\n        fitView: true,\n        children: [/*#__PURE__*/_jsxDEV(MiniMap, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 773,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 774,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Background, {\n          gap: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 775,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 756,\n        columnNumber: 9\n      }, this), ctxMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'fixed',\n          top: ctxMenu.y,\n          left: ctxMenu.x,\n          background: '#fff',\n          border: '1px solid #e5e7eb',\n          borderRadius: 8,\n          boxShadow: '0 8px 24px rgba(0,0,0,.12)',\n          overflow: 'hidden',\n          zIndex: 60\n        },\n        onMouseLeave: ctxClose,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn secondary\",\n          style: {\n            borderRadius: 0,\n            width: 180\n          },\n          onClick: ctxRename,\n          children: \"Renomear\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 788,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn secondary\",\n          style: {\n            borderRadius: 0,\n            width: 180\n          },\n          onClick: ctxDuplicate,\n          children: \"Duplicar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 789,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn secondary\",\n          style: {\n            borderRadius: 0,\n            width: 180\n          },\n          onClick: ctxReset,\n          children: \"Resetar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 790,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn danger\",\n          style: {\n            borderRadius: 0,\n            width: 180\n          },\n          onClick: ctxDelete,\n          children: \"Deletar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 791,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 780,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Drawer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 796,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 755,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 727,\n    columnNumber: 5\n  }, this);\n}\n_s2(JourneyBuilder, \"TCPxXiRW3LbhU2tD76szIau2tNg=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c9 = JourneyBuilder;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9;\n$RefreshReg$(_c, \"Card\");\n$RefreshReg$(_c2, \"EndNode\");\n$RefreshReg$(_c3, \"MessageNode\");\n$RefreshReg$(_c4, \"ApiNode\");\n$RefreshReg$(_c5, \"CodeNode\");\n$RefreshReg$(_c6, \"AudienceNode\");\n$RefreshReg$(_c7, \"DelayNode\");\n$RefreshReg$(_c8, \"AudiencePanel\");\n$RefreshReg$(_c9, \"JourneyBuilder\");","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","ReactFlow","Background","Controls","MiniMap","addEdge","useEdgesState","useNodesState","MarkerType","Handle","Position","Papa","jsxDEV","_jsxDEV","Fragment","_Fragment","PIN","uid","p","Date","now","Math","floor","random","slug","s","String","trim","toLowerCase","replace","makeDefaultFlow","audId","nodes","id","type","position","x","y","data","headers","rows","mapping","phoneKey","selectable","edges","Card","title","subtitle","selected","children","style","background","border","borderRadius","width","boxShadow","padding","borderBottom","fontWeight","color","fileName","_jsxFileName","lineNumber","columnNumber","fontSize","_c","EndNode","Left","height","_c2","MessageNode","label","channel","toUpperCase","mode","Right","_c3","ApiNode","_c4","CodeNode","_c5","AudienceNode","_c6","DelayNode","until","amount","unit","_c7","AudiencePanel","node","patchNode","inputStyle","slugFn","_s","d","setHeaders","setRows","setMapping","setPhoneKey","onFile","e","_e$target$files","f","target","files","parse","header","skipEmptyLines","complete","res","hs","meta","fields","Object","keys","guess","forEach","h","pk","find","test","slice","saveMap","alert","accept","onChange","length","value","map","display","gridTemplateColumns","gap","maxHeight","overflow","alignSelf","textAlign","placeholder","m","className","onClick","marginTop","JSON","stringify","_c8","JourneyBuilder","_s2","def","setNodes","baseOnNodesChange","setEdges","baseOnEdgesChange","rf","setRf","selectedId","setSelectedId","selectedNode","n","flowId","setFlowId","flowName","setFlowName","dirty","setDirty","templates","setTemplates","fetch","then","r","json","contents","catch","sp","URLSearchParams","window","location","search","get","base","ok","Promise","reject","Array","isArray","name","raw","localStorage","getItem","requestAnimationFrame","fitView","includeHiddenNodes","vp","getViewport","zoom","setViewport","onNodesChange","changes","onEdgesChange","patch","nds","onConnect","params","eds","filtered","filter","source","stroke","markerEnd","ArrowClosed","onSelectionChange","ns","_ns$0$id","_ns$","onDragStart","dataTransfer","setData","effectAllowed","createNodeByType","text","method","url","body","mappings","lastResponse","code","onDrop","preventDefault","getData","pos","project","clientX","clientY","concat","onDragOver","dropEffect","ctxMenu","setCtxMenu","onNodeContextMenu","evt","ctxClose","ctxDelete","ctxDuplicate","copy","ctxRename","_n$data","val","prompt","ctxReset","fresh","autoLayout","root","nid","visited","Set","levels","q","_levels$id","shift","has","add","min","Infinity","t","push","byLevel","entries","lv","X0","XG","Y0","YG","newPos","Number","sort","a","b","i","ensureEndForPayload","nodesIn","edgesIn","hasEnd","some","nodesOut","edgesOut","outBy","sinks","maxX","max","avgY","reduce","endNode","newEdges","sourceHandle","targetHandle","saveFlow","payload","updatedAt","toISOString","Error","saved","u","URL","href","searchParams","set","history","replaceState","toString","setItem","exportFlow","blob","Blob","document","createElement","createObjectURL","download","click","importFlow","_e$target$files2","txt","j","nodeTypes","end","message","api","audience","delay","small","marginBottom","TemplatesOptions","sid","friendly_name","Drawer","open","wrap","top","right","transform","transition","zIndex","_Object$values$","found","templateSid","firstTypeBody","values","types","readOnly","fontFamily","mediaUrl","buttonsJson","tryParse","testRequest","undefined","addMapping","path","var","updateMap","idx","removeMap","splice","_d$amount","chip","cursor","userSelect","goBack","wantSave","confirm","gridTemplateRows","alignItems","marginLeft","draggable","minWidth","onInit","minZoom","maxZoom","defaultViewport","left","onMouseLeave","_c9","$RefreshReg$"],"sources":["/Users/gustsantos/Desktop/initucastt/frontend/src/pages/JourneyBuilder.jsx"],"sourcesContent":["// frontend/src/pages/JourneyBuilder.jsx\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport ReactFlow, {\n  Background,\n  Controls,\n  MiniMap,\n  addEdge,\n  useEdgesState,\n  useNodesState,\n  MarkerType,\n  Handle,\n  Position,\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport Papa from 'papaparse';\n\nconst PIN = 14;\n\n// ---------- helpers ----------\nconst uid = (p) => `${p}_${Date.now()}_${Math.floor(Math.random() * 9999)}`;\nconst slug = (s) =>\n  String(s || '')\n    .trim()\n    .toLowerCase()\n    .replace(/\\s+/g, '_')\n    .replace(/[^\\w]/g, '_')\n    .replace(/_+/g, '_');\n\nconst makeDefaultFlow = () => {\n  const audId = uid('aud');\n  return {\n    nodes: [\n      {\n        id: audId,\n        type: 'audience',\n        position: { x: 160, y: 200 },\n        data: { headers: [], rows: [], mapping: {}, phoneKey: '' },\n        selectable: true,\n      },\n    ],\n    edges: [],\n  };\n};\n\n// ---------- cards / nodes ----------\nconst Card = ({ title, subtitle, selected, children }) => (\n  <div\n    style={{\n      background: '#fff',\n      border: selected ? '2px solid #2563eb' : '1px solid #e5e7eb',\n      borderRadius: 12,\n      width: 340,\n      boxShadow: '0 2px 8px rgba(0,0,0,.06)',\n    }}\n  >\n    <div style={{ padding: '12px 14px', borderBottom: '1px solid #f1f5f9' }}>\n      <div style={{ fontWeight: 800, color: '#0f172a' }}>{title}</div>\n      {subtitle ? <div style={{ fontSize: 12, color: '#64748b' }}>{subtitle}</div> : null}\n    </div>\n    <div style={{ padding: 12 }}>{children}</div>\n  </div>\n);\n\nconst EndNode = ({ selected }) => (\n  <Card title=\"End\" subtitle=\"término do fluxo\" selected={selected}>\n    <div style={{ fontSize: 12, color: '#475569' }}>Nó terminal. Só recebe conexões.</div>\n    <Handle type=\"target\" position={Position.Left} id=\"in\"\n      style={{ background: '#6b7280', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\nconst MessageNode = ({ data, selected }) => (\n  <Card\n    title={data.label || 'Mensagem'}\n    subtitle={`Canal: ${String(data.channel || 'whatsapp').toUpperCase()} • Tipo: ${data.mode || 'text'}`}\n    selected={selected}\n  >\n    <div style={{ fontSize: 12, color: '#475569' }}>Conteúdo configurável no painel ao lado.</div>\n    <Handle type=\"target\" position={Position.Left} id=\"in\"\n      style={{ background: '#6b7280', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n    <Handle type=\"source\" position={Position.Right} id=\"out\"\n      style={{ background: '#16a34a', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\nconst ApiNode = ({ selected }) => (\n  <Card title=\"API Call\" selected={selected}>\n    <div style={{ fontSize: 12, color: '#475569' }}>\n      Configure método/URL no painel ao lado. Salva variáveis via mapeamentos.\n    </div>\n    <Handle type=\"target\" position={Position.Left} id=\"in\"\n      style={{ background: '#6b7280', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n    <Handle type=\"source\" position={Position.Right} id=\"out\"\n      style={{ background: '#16a34a', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\nconst CodeNode = ({ selected }) => (\n  <Card title=\"Code\" subtitle=\"JS custom\" selected={selected}>\n    <div style={{ fontSize: 12, color: '#475569' }}>\n      Cole seu JS no painel ao lado. Deve retornar um objeto de variáveis.\n    </div>\n    <Handle type=\"target\" position={Position.Left} id=\"in\"\n      style={{ background: '#6b7280', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n    <Handle type=\"source\" position={Position.Right} id=\"out\"\n      style={{ background: '#16a34a', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\nconst AudienceNode = ({ selected }) => (\n  <Card title=\"Audiência\" subtitle=\"CSV → variáveis\" selected={selected}>\n    <div style={{ fontSize: 12, color: '#475569' }}>\n      Faça upload e mapeie colunas no painel (drawer) ao lado.\n    </div>\n    <Handle type=\"source\" position={Position.Right} id=\"out\"\n      style={{ background: '#16a34a', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\nconst DelayNode = ({ data, selected }) => (\n  <Card\n    title=\"Delay\"\n    subtitle={data.mode === 'until'\n      ? `até ${data.until || '—'}`\n      : `${data.amount || 0} ${data.unit || 'seconds'}`}\n    selected={selected}\n  >\n    <div style={{ fontSize: 12, color: '#475569' }}>Espera antes de seguir para o próximo nó.</div>\n    <Handle type=\"target\" position={Position.Left} id=\"in\"\n      style={{ background: '#6b7280', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n    <Handle type=\"source\" position={Position.Right} id=\"out\"\n      style={{ background: '#16a34a', width: PIN, height: PIN, border: '2px solid #fff' }}/>\n  </Card>\n);\n\n// ---------- Panels ----------\nfunction AudiencePanel({ node, patchNode, inputStyle, label, slugFn }) {\n  const d = node.data || {};\n  const [headers, setHeaders] = useState(d.headers || []);\n  const [rows, setRows] = useState(d.rows || []);\n  const [mapping, setMapping] = useState(d.mapping || {});\n  const [phoneKey, setPhoneKey] = useState(d.phoneKey || '');\n\n  useEffect(() => {\n    setHeaders(d.headers || []);\n    setRows(d.rows || []);\n    setMapping(d.mapping || {});\n    setPhoneKey(d.phoneKey || '');\n  }, [node.id]);\n\n  const onFile = (e) => {\n    const f = e.target.files?.[0];\n    if (!f) return;\n    Papa.parse(f, {\n      header: true,\n      skipEmptyLines: true,\n      complete: (res) => {\n        const hs = res.meta.fields || Object.keys(res.data[0] || {});\n        const guess = {};\n        hs.forEach((h) => (guess[h] = slugFn(h)));\n        const pk = hs.find((h) => /phone|telefone|celular|numero|n[uú]mero/i.test(h)) || '';\n        setHeaders(hs);\n        setRows(res.data.slice(0, 5));\n        setMapping(guess);\n        setPhoneKey(pk);\n      },\n    });\n  };\n\n  const saveMap = () => {\n    if (!phoneKey) {\n      alert('Escolha a coluna de telefone.');\n      return;\n    }\n    patchNode(node.id, { headers, rows, mapping, phoneKey });\n    alert('Mapeamento salvo.');\n  };\n\n  return (\n    <>\n      {label('Arquivo CSV')}\n      <input type=\"file\" accept=\".csv\" onChange={onFile} />\n      {headers.length > 0 && (\n        <>\n          {label('Coluna de telefone')}\n          <select style={inputStyle} value={phoneKey} onChange={(e) => setPhoneKey(e.target.value)}>\n            <option value=\"\">— selecione —</option>\n            {headers.map((h) => (<option key={h} value={h}>{h}</option>))}\n          </select>\n\n          {label('Mapeamento (coluna → variável)')}\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 20px 1fr', gap: 8, maxHeight: 200, overflow: 'auto' }}>\n            {headers.map((h) => (\n              <React.Fragment key={h}>\n                <div style={{ alignSelf: 'center', fontSize: 13 }}>{h}</div>\n                <div style={{ textAlign: 'center', color: '#94a3b8' }}>→</div>\n                <input\n                  style={inputStyle}\n                  value={mapping[h] || ''}\n                  placeholder={slugFn(h)}\n                  onChange={(e) => setMapping((m) => ({ ...m, [h]: slugFn(e.target.value) }))}\n                />\n              </React.Fragment>\n            ))}\n          </div>\n\n          <button className=\"btn\" onClick={saveMap} style={{ marginTop: 10 }}>\n            Salvar mapeamento\n          </button>\n\n          {rows.length > 0 && (\n            <>\n              {label('Amostra (5 primeiras linhas)')}\n              <pre\n                style={{\n                  background: '#f8fafc',\n                  border: '1px solid #e2e8f0',\n                  borderRadius: 8,\n                  padding: 10,\n                  fontSize: 12,\n                  maxHeight: 160,\n                  overflow: 'auto',\n                }}\n              >\n                {JSON.stringify(rows, null, 2)}\n              </pre>\n            </>\n          )}\n        </>\n      )}\n    </>\n  );\n}\n\n// ---------- main ----------\nexport default function JourneyBuilder() {\n  const def = makeDefaultFlow();\n  const [nodes, setNodes, baseOnNodesChange] = useNodesState(def.nodes);\n  const [edges, setEdges, baseOnEdgesChange] = useEdgesState(def.edges);\n\n  const [rf, setRf] = useState(null);\n  const [selectedId, setSelectedId] = useState(null);\n  const selectedNode = useMemo(() => nodes.find((n) => n.id === selectedId), [nodes, selectedId]);\n\n  const [flowId, setFlowId] = useState(null);\n  const [flowName, setFlowName] = useState('Novo Flow');\n  const [dirty, setDirty] = useState(false);\n\n  // templates Twilio\n  const [templates, setTemplates] = useState([]);\n  useEffect(() => {\n    fetch('/api/templates/list')\n      .then((r) => r.json())\n      .then((data) => setTemplates(data.contents || []))\n      .catch(() => setTemplates([]));\n  }, []);\n\n  // carregar por ?id= (ou default com apenas Audiência)\n  useEffect(() => {\n    const sp = new URLSearchParams(window.location.search);\n    const id = sp.get('id');\n\n    if (!id) {\n      const base = makeDefaultFlow();\n      setNodes(base.nodes);\n      setEdges(base.edges);\n      return;\n    }\n\n    setFlowId(id);\n    fetch(`/api/journeys/${id}`)\n      .then((r) => (r.ok ? r.json() : Promise.reject()))\n      .then((f) => {\n        if (Array.isArray(f.nodes) && Array.isArray(f.edges) && f.nodes.length) {\n          setNodes(f.nodes);\n          setEdges(f.edges);\n          if (f.name) setFlowName(f.name);\n        } else {\n          const base = makeDefaultFlow();\n          setNodes(base.nodes);\n          setEdges(base.edges);\n        }\n      })\n      .catch(() => {\n        const raw = localStorage.getItem(id);\n        if (raw) {\n          try {\n            const f = JSON.parse(raw);\n            if (Array.isArray(f.nodes) && Array.isArray(f.edges) && f.nodes.length) {\n              setNodes(f.nodes);\n              setEdges(f.edges);\n              if (f.name) setFlowName(f.name);\n              return;\n            }\n          } catch {}\n        }\n        const base = makeDefaultFlow();\n        setNodes(base.nodes);\n        setEdges(base.edges);\n      });\n  }, [setNodes, setEdges]);\n\n  // fit agradável quando há nós\n  useEffect(() => {\n    if (!rf || nodes.length === 0) return;\n    requestAnimationFrame(() => {\n      try {\n        rf.fitView({ padding: 0.2, includeHiddenNodes: false });\n        const vp = rf.getViewport();\n        if (vp?.zoom > 1.1) rf.setViewport({ x: vp.x, y: vp.y, zoom: 0.9 });\n        if (vp?.zoom < 0.3) rf.setViewport({ x: vp.x, y: vp.y, zoom: 0.5 });\n      } catch {}\n    });\n  }, [rf, nodes]);\n\n  // wrappers que marcam dirty\n  const onNodesChange = useCallback((changes) => {\n    setDirty(true);\n    baseOnNodesChange(changes);\n  }, [baseOnNodesChange]);\n\n  const onEdgesChange = useCallback((changes) => {\n    setDirty(true);\n    baseOnEdgesChange(changes);\n  }, [baseOnEdgesChange]);\n\n  const patchNode = useCallback((id, patch) => {\n    setDirty(true);\n    setNodes((nds) => nds.map((n) => (n.id === id ? { ...n, data: { ...n.data, ...patch } } : n)));\n  }, [setNodes]);\n\n  // 1 saída por nó\n  const onConnect = useCallback((params) => {\n    setDirty(true);\n    setEdges((eds) => {\n      const filtered = eds.filter((e) => e.source !== params.source);\n      return addEdge(\n        { ...params, type: 'smoothstep', style: { stroke: '#0f172a' }, markerEnd: { type: MarkerType.ArrowClosed, color: '#0f172a' } },\n        filtered\n      );\n    });\n  }, [setEdges]);\n\n  const onSelectionChange = useCallback(({ nodes: ns }) => {\n    setSelectedId(ns?.[0]?.id ?? null);\n  }, []);\n\n  // drag & drop\n  const onDragStart = (e, type) => {\n    e.dataTransfer.setData('application/x-node-type', type);\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const createNodeByType = (type, position) => {\n    const id = uid(type);\n    if (type === 'message') return { id, type: 'message', position, data: { label: 'Mensagem', channel: 'whatsapp', mode: 'text', text: '' } };\n    if (type === 'api')     return { id, type: 'api', position, data: { label: 'API Call', method: 'GET', url: '', headers: '{}', body: '{}', mappings: [], lastResponse: '' } };\n    if (type === 'code')    return { id, type: 'code', position, data: { label: 'Code', code: '// return { nova_variavel: 123 };' } };\n    if (type === 'audience')return { id, type: 'audience', position, data: { headers: [], rows: [], mapping: {}, phoneKey: '' } };\n    if (type === 'delay')   return { id, type: 'delay', position, data: { mode: 'duration', amount: 30, unit: 'seconds', until: '' } };\n    if (type === 'end')     return { id, type: 'end', position, data: {} };\n    return null;\n  };\n\n  const onDrop = useCallback((e) => {\n    e.preventDefault();\n    const type = e.dataTransfer.getData('application/x-node-type');\n    if (!rf || !type) return;\n    const pos = rf.project({ x: e.clientX, y: e.clientY });\n    const node = createNodeByType(type, pos);\n    if (!node) return;\n    setNodes((nds) => nds.concat(node));\n    setDirty(true);\n  }, [rf, setNodes]);\n\n  const onDragOver = useCallback((e) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  // context menu\n  const [ctxMenu, setCtxMenu] = useState(null);\n  const onNodeContextMenu = (evt, node) => {\n    evt.preventDefault();\n    setCtxMenu({ x: evt.clientX, y: evt.clientY, id: node.id });\n  };\n  const ctxClose = () => setCtxMenu(null);\n  const ctxDelete = () => {\n    if (!ctxMenu) return;\n    const id = ctxMenu.id;\n    setEdges((eds) => eds.filter((e) => e.source !== id && e.target !== id));\n    setNodes((nds) => nds.filter((n) => n.id !== id));\n    setSelectedId(null);\n    setDirty(true);\n    ctxClose();\n  };\n  const ctxDuplicate = () => {\n    if (!ctxMenu) return;\n    const n = nodes.find((x) => x.id === ctxMenu.id);\n    if (!n) return;\n    const copy = { ...n, id: uid(n.type), position: { x: n.position.x + 40, y: n.position.y + 40 } };\n    setNodes((nds) => nds.concat(copy));\n    setDirty(true);\n    ctxClose();\n  };\n  const ctxRename = () => {\n    if (!ctxMenu) return;\n    const n = nodes.find((x) => x.id === ctxMenu.id);\n    if (!n) return;\n    const val = prompt('Novo nome/label do nó:', n.data?.label || '');\n    if (val != null) patchNode(n.id, { label: val });\n    ctxClose();\n  };\n  const ctxReset = () => {\n    if (!ctxMenu) return;\n    const n = nodes.find((x) => x.id === ctxMenu.id);\n    if (!n) return;\n    const fresh = createNodeByType(n.type, n.position);\n    if (fresh) patchNode(n.id, fresh.data || {});\n    ctxClose();\n  };\n\n  // auto-layout simples\n  const autoLayout = () => {\n    const root = nodes.find((n) => n.type === 'audience') || nodes[0];\n    if (!root) return;\n    const children = (nid) => edges.filter((e) => e.source === nid).map((e) => e.target);\n    const visited = new Set();\n    const levels = {};\n    const q = [{ id: root.id, d: 0 }];\n    while (q.length) {\n      const { id, d } = q.shift();\n      if (visited.has(id)) continue;\n      visited.add(id);\n      levels[id] = Math.min(levels[id] ?? Infinity, d);\n      children(id).forEach((t) => q.push({ id: t, d: d + 1 }));\n    }\n    const byLevel = {};\n    Object.entries(levels).forEach(([id, lv]) => {\n      byLevel[lv] = byLevel[lv] || [];\n      byLevel[lv].push(id);\n    });\n\n    const X0 = 160, XG = 420, Y0 = 160, YG = 180;\n    const newPos = {};\n    Object.keys(byLevel).map(Number).sort((a, b) => a - b).forEach((lv) => {\n      byLevel[lv].forEach((id, i) => (newPos[id] = { x: X0 + lv * XG, y: Y0 + i * YG }));\n    });\n\n    setNodes((nds) => nds.map((n) => (newPos[n.id] ? { ...n, position: newPos[n.id] } : n)));\n    setDirty(true);\n  };\n\n  // salvar – adiciona um único End (se não existir) e conecta todos os \"sinks\"\n  const ensureEndForPayload = (nodesIn, edgesIn) => {\n    const hasEnd = nodesIn.some((n) => n.type === 'end');\n    if (hasEnd) return { nodesOut: nodesIn, edgesOut: edgesIn };\n\n    const outBy = {};\n    edgesIn.forEach((e) => { outBy[e.source] = true; });\n    const sinks = nodesIn.filter((n) => n.type !== 'end' && !outBy[n.id]);\n\n    // posição do End: à direita do mais “à direita”\n    const maxX = Math.max(...nodesIn.map((n) => n.position.x));\n    const avgY = sinks.length ? (sinks.reduce((a, n) => a + n.position.y, 0) / sinks.length) : 200;\n    const endNode = { id: uid('end'), type: 'end', position: { x: maxX + 420, y: avgY }, data: {} };\n\n    const newEdges = edgesIn.slice();\n    sinks.forEach((s) => {\n      newEdges.push({\n        id: uid('e'),\n        source: s.id,\n        target: endNode.id,\n        sourceHandle: 'out',\n        targetHandle: 'in',\n        type: 'smoothstep',\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#0f172a' },\n        style: { stroke: '#0f172a' },\n      });\n    });\n    return { nodesOut: nodesIn.concat(endNode), edgesOut: newEdges };\n  };\n\n  const saveFlow = async () => {\n    // monta payload (com End auto)\n    const { nodesOut, edgesOut } = ensureEndForPayload(nodes, edges);\n    const id = flowId || 'flow_' + Date.now();\n    const payload = { id, name: flowName || 'Sem nome', nodes: nodesOut, edges: edgesOut, updatedAt: new Date().toISOString() };\n\n    try {\n      const url = flowId ? `/api/journeys/${flowId}` : '/api/journeys';\n      const method = flowId ? 'PUT' : 'POST';\n      const res = await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });\n      if (!res.ok) throw new Error('no backend');\n      const saved = await res.json();\n      alert('Flow salvo no backend!');\n      // reflete o End no canvas e marca como não sujo\n      setNodes(nodesOut);\n      setEdges(edgesOut);\n      setDirty(false);\n      if (!flowId && saved?.id) {\n        setFlowId(saved.id);\n        const u = new URL(window.location.href); u.searchParams.set('id', saved.id); window.history.replaceState(null, '', u.toString());\n      }\n    } catch {\n      localStorage.setItem(id, JSON.stringify(payload));\n      alert('Flow salvo no navegador.');\n      setNodes(nodesOut);\n      setEdges(edgesOut);\n      setDirty(false);\n      if (!flowId) {\n        setFlowId(id);\n        const u = new URL(window.location.href); u.searchParams.set('id', id); window.history.replaceState(null, '', u.toString());\n      }\n    }\n  };\n\n  const exportFlow = () => {\n    const blob = new Blob([JSON.stringify({ id: flowId || 'temp', name: flowName, nodes, edges }, null, 2)], { type: 'application/json' });\n    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `${slug(flowName || 'flow')}.json`; a.click();\n  };\n\n  const importFlow = async (e) => {\n    const f = e.target.files?.[0]; if (!f) return;\n    const txt = await f.text();\n    try {\n      const j = JSON.parse(txt);\n      if (Array.isArray(j.nodes) && Array.isArray(j.edges)) {\n        setNodes(j.nodes); setEdges(j.edges); if (j.name) setFlowName(j.name);\n        if (j.id) { setFlowId(j.id); const u = new URL(window.location.href); u.searchParams.set('id', j.id); window.history.replaceState(null, '', u.toString()); }\n        setDirty(true);\n      } else alert('Arquivo inválido.');\n    } catch { alert('JSON inválido.'); }\n    finally { e.target.value = ''; }\n  };\n\n  // node types\n  const nodeTypes = useMemo(() => ({\n    end: EndNode, message: MessageNode, api: ApiNode, code: CodeNode, audience: AudienceNode, delay: DelayNode,\n  }), []);\n\n  // Drawer (aparece só quando há nó selecionado)\n  const inputStyle = { width: '100%', border: '1px solid #cbd5e1', borderRadius: 8, padding: '10px 12px' };\n  const small = { fontSize: 12, color: '#475569', marginBottom: 6 };\n  const label = (t) => <div style={small}>{t}</div>;\n\n  const TemplatesOptions = ({ value, onChange }) => (\n    <select value={value || ''} onChange={(e) => onChange(e.target.value)} style={inputStyle}>\n      <option value=\"\">— none —</option>\n      {templates.map((t) => (<option key={t.sid} value={t.sid}>{t.friendly_name || t.sid}</option>))}\n    </select>\n  );\n\n  const Drawer = () => {\n    const open = !!selectedNode;\n    const wrap = {\n      position: 'fixed', top: 64, right: 16, width: 360, height: 'calc(100vh - 80px)',\n      background: '#fff', border: '1px solid #e5e7eb', borderRadius: 12, boxShadow: '0 12px 24px rgba(0,0,0,.08)',\n      transform: `translateX(${open ? 0 : 420}px)`, transition: 'transform .25s ease',\n      padding: 16, zIndex: 50, overflow: 'auto',\n    };\n\n    if (!selectedNode) return <div style={wrap}><div style={{color:'#94a3b8'}}>Selecione um nó.</div></div>;\n    const n = selectedNode;\n\n    // MESSAGE\n    if (n.type === 'message') {\n      const d = n.data || {};\n      const found = d.templateSid ? templates.find((t) => t.sid === d.templateSid) : null;\n      const firstTypeBody = found ? (Object.values(found.types || {})[0]?.body || '') : '';\n      return (\n        <div style={wrap}>\n          {label('Label')}\n          <input style={inputStyle} value={d.label || ''} onChange={(e) => patchNode(n.id, { label: e.target.value })}/>\n          {label('Canal')}\n          <select style={inputStyle} value={d.channel || 'whatsapp'} onChange={(e) => patchNode(n.id, { channel: e.target.value })}>\n            <option value=\"whatsapp\">WhatsApp</option><option value=\"sms\">SMS</option>\n          </select>\n          {label('Mode')}\n          <select style={inputStyle} value={d.mode || 'text'} onChange={(e) => patchNode(n.id, { mode: e.target.value })}>\n            <option value=\"text\">Text</option><option value=\"rich\">Rich (text + image + buttons)</option>\n          </select>\n          {label('Pick a Twilio template (optional)')}\n          <TemplatesOptions value={d.templateSid} onChange={(val) => patchNode(n.id, { templateSid: val })}/>\n          {found && (<><div style={small}>Template preview</div><textarea readOnly rows={6} style={{ ...inputStyle, fontFamily: 'monospace' }} value={firstTypeBody}/></>)}\n          {label('Text')}\n          <textarea rows={8} style={inputStyle} value={d.text || ''} onChange={(e) => patchNode(n.id, { text: e.target.value })} placeholder=\"Olá {{nome}}!\"/>\n          {d.mode === 'rich' && (\n            <>\n              {label('Media URL')}\n              <input style={inputStyle} value={d.mediaUrl || ''} onChange={(e) => patchNode(n.id, { mediaUrl: e.target.value })} placeholder=\"https://...\"/>\n              {label('Buttons (JSON opcional)')}\n              <textarea rows={6} style={inputStyle} value={d.buttonsJson || ''} onChange={(e) => patchNode(n.id, { buttonsJson: e.target.value })}\n                placeholder='[{\"type\":\"reply\",\"title\":\"Sim\",\"id\":\"YES\"}]'/>\n            </>\n          )}\n        </div>\n      );\n    }\n\n    // API\n    if (n.type === 'api') {\n      const d = n.data || {};\n      const tryParse = (txt) => { try { return JSON.stringify(JSON.parse(txt), null, 2); } catch { return txt; } };\n      const testRequest = async () => {\n        try {\n          const headers = d.headers ? JSON.parse(d.headers) : {};\n          const body = (d.method === 'GET' || d.method === 'DELETE') ? undefined : (d.body && d.body.trim() !== '{}' ? JSON.parse(d.body) : undefined);\n          const res = await fetch(d.url, { method: d.method || 'GET', headers, body: body ? JSON.stringify(body) : undefined });\n          const text = await res.text(); patchNode(n.id, { lastResponse: text }); alert('Request executada. Veja a resposta abaixo.');\n        } catch (e) { alert('Falha ao executar request: ' + e.message); }\n      };\n      const addMapping = () => { const m = Array.isArray(d.mappings) ? d.mappings.slice() : []; m.push({ path: '', var: '' }); patchNode(n.id, { mappings: m }); };\n      const updateMap = (idx, patch) => { const m = (d.mappings || []).slice(); m[idx] = { ...m[idx], ...patch }; patchNode(n.id, { mappings: m }); };\n      const removeMap = (idx) => { const m = (d.mappings || []).slice(); m.splice(idx, 1); patchNode(n.id, { mappings: m }); };\n\n      return (\n        <div style={wrap}>\n          {label('Label')}\n          <input style={inputStyle} value={d.label || 'API Call'} onChange={(e) => patchNode(n.id, { label: e.target.value })}/>\n          {label('Método')}\n          <select style={inputStyle} value={d.method || 'GET'} onChange={(e) => patchNode(n.id, { method: e.target.value })}>\n            <option>GET</option><option>POST</option><option>PUT</option><option>PATCH</option><option>DELETE</option>\n          </select>\n          {label('URL')}\n          <input style={inputStyle} placeholder=\"https://api.meuservico.com/...\" value={d.url || ''} onChange={(e) => patchNode(n.id, { url: e.target.value })}/>\n          {label('Headers (JSON)')}\n          <textarea rows={4} style={inputStyle} value={d.headers || '{}'} onChange={(e) => patchNode(n.id, { headers: e.target.value })}/>\n          {(d.method === 'POST' || d.method === 'PUT' || d.method === 'PATCH') && (<>\n            {label('Body (JSON)')}\n            <textarea rows={6} style={inputStyle} value={d.body || '{}'} onChange={(e) => patchNode(n.id, { body: e.target.value })}/>\n          </>)}\n          <button className=\"btn\" onClick={testRequest} style={{ marginTop: 10 }}>Executar request</button>\n          {label('Resposta (último teste)')}\n          <textarea rows={8} style={{ ...inputStyle, fontFamily: 'monospace' }} readOnly value={tryParse(d.lastResponse || '')}/>\n          {label('Mapeamentos JSON → Variáveis')}\n          {(d.mappings || []).map((m, i) => (\n            <div key={i} style={{ display: 'grid', gridTemplateColumns: '1fr 1fr auto', gap: 8, marginBottom: 8 }}>\n              <input style={inputStyle} placeholder=\"ex.: data.user.id\" value={m.path} onChange={(e) => updateMap(i, { path: e.target.value })}/>\n              <input style={inputStyle} placeholder=\"ex.: user_id\" value={m.var} onChange={(e) => updateMap(i, { var: slug(e.target.value) })}/>\n              <button className=\"btn danger\" onClick={() => removeMap(i)}>x</button>\n            </div>\n          ))}\n          <button className=\"btn\" onClick={addMapping}>+ adicionar mapeamento</button>\n        </div>\n      );\n    }\n\n    // CODE\n    if (n.type === 'code') {\n      const d = n.data || {};\n      return (\n        <div style={wrap}>\n          {label('Label')}\n          <input style={inputStyle} value={d.label || 'Code'} onChange={(e) => patchNode(n.id, { label: e.target.value })}/>\n          {label('JavaScript')}\n          <textarea rows={14} style={{ ...inputStyle, fontFamily: 'monospace' }} value={d.code || ''}\n            onChange={(e) => patchNode(n.id, { code: e.target.value })}\n            placeholder={`// Recebe \"context\" (variáveis atuais)\\n// deve retornar um objeto com novas variáveis\\nreturn { nova_variavel: 123 };`}/>\n        </div>\n      );\n    }\n\n    // AUDIENCE\n    if (n.type === 'audience') {\n      return (\n        <div style={wrap}>\n          <AudiencePanel node={n} patchNode={patchNode} inputStyle={inputStyle} label={label} slugFn={slug}/>\n        </div>\n      );\n    }\n\n    // DELAY\n    if (n.type === 'delay') {\n      const d = n.data || {};\n      return (\n        <div style={wrap}>\n          {label('Modo')}\n          <select style={inputStyle} value={d.mode || 'duration'} onChange={(e) => patchNode(n.id, { mode: e.target.value })}>\n            <option value=\"duration\">Por duração</option>\n            <option value=\"until\">Até data/hora</option>\n          </select>\n          {d.mode === 'duration' ? (\n            <>\n              {label('Quantidade')}\n              <input type=\"number\" min={0} style={inputStyle} value={d.amount ?? 0}\n                onChange={(e) => patchNode(n.id, { amount: Number(e.target.value) })}/>\n              {label('Unidade')}\n              <select style={inputStyle} value={d.unit || 'seconds'} onChange={(e) => patchNode(n.id, { unit: e.target.value })}>\n                <option value=\"seconds\">seconds</option><option value=\"minutes\">minutes</option>\n                <option value=\"hours\">hours</option><option value=\"days\">days</option>\n                <option value=\"weeks\">weeks</option><option value=\"months\">months</option>\n              </select>\n            </>\n          ) : (\n            <>\n              {label('Executar após (data/hora)')}\n              <input type=\"datetime-local\" style={inputStyle} value={d.until || ''} onChange={(e) => patchNode(n.id, { until: e.target.value })}/>\n            </>\n          )}\n        </div>\n      );\n    }\n\n    return <div style={wrap}><div style={{color:'#64748b'}}>Este nó não possui propriedades.</div></div>;\n  };\n\n  // UI\n  const chip = {\n    display: 'inline-block', background: '#eef2ff', color: '#1e3a8a',\n    border: '1px solid #c7d2fe', borderRadius: 24, padding: '6px 12px',\n    fontSize: 13, fontWeight: 700, cursor: 'grab', userSelect: 'none',\n  };\n\n  // botão Voltar com confirmação de salvar\n  const goBack = async () => {\n    if (dirty) {\n      const wantSave = window.confirm('Você deseja salvar o fluxo antes de sair?');\n      if (wantSave) {\n        await saveFlow();\n      }\n    }\n    window.location.href = '/journeys';\n  };\n\n  return (\n    <div style={{ height: '100vh', display: 'grid', gridTemplateRows: '56px 1fr' }}>\n      {/* Top bar */}\n      <div style={{ display: 'flex', alignItems: 'center', gap: 8, padding: '10px 12px' }}>\n        <button className=\"btn\" onClick={goBack}>← Voltar</button>\n\n        <div style={{ marginLeft: 12, color: '#4b5563', fontSize: 13 }}>Arraste para o canvas:</div>\n        <div draggable onDragStart={(e) => onDragStart(e, 'message')} style={chip} title=\"Mensagem\">Mensagem</div>\n        <div draggable onDragStart={(e) => onDragStart(e, 'api')} style={chip} title=\"API\">API</div>\n        <div draggable onDragStart={(e) => onDragStart(e, 'code')} style={chip} title=\"Code\">Code</div>\n        <div draggable onDragStart={(e) => onDragStart(e, 'audience')} style={chip} title=\"Audiência\">Audiência</div>\n        <div draggable onDragStart={(e) => onDragStart(e, 'delay')} style={chip} title=\"Delay\">Delay</div>\n        {/* End removido da paleta */}\n\n        <input value={flowName} onChange={(e) => { setFlowName(e.target.value); setDirty(true); }}\n          placeholder=\"Nome do flow\"\n          style={{ marginLeft: 16, border: '1px solid #e5e7eb', borderRadius: 8, padding: '8px 12px', minWidth: 220 }}/>\n\n        <button className=\"btn\" style={{ marginLeft: 'auto' }} onClick={autoLayout}>Auto-layout</button>\n\n        <label className=\"btn secondary\" style={{ cursor: 'pointer' }}>\n          Importar\n          <input type=\"file\" accept=\"application/json\" onChange={importFlow} style={{ display: 'none' }}/>\n        </label>\n        <button className=\"btn secondary\" onClick={exportFlow}>Exportar</button>\n        <button className=\"btn\" onClick={saveFlow}>Salvar flow</button>\n      </div>\n\n      {/* Canvas */}\n      <div style={{ position: 'relative' }}>\n        <ReactFlow\n          nodes={nodes}\n          edges={edges}\n          nodeTypes={nodeTypes}\n          onNodesChange={onNodesChange}\n          onEdgesChange={onEdgesChange}\n          onConnect={onConnect}\n          onSelectionChange={onSelectionChange}\n          onNodeContextMenu={onNodeContextMenu}\n          onInit={setRf}\n          onDrop={onDrop}\n          onDragOver={onDragOver}\n          minZoom={0.2}\n          maxZoom={1.5}\n          defaultViewport={{ x: 0, y: 0, zoom: 0.9 }}\n          fitView\n        >\n          <MiniMap />\n          <Controls />\n          <Background gap={16} />\n        </ReactFlow>\n\n        {/* Context menu */}\n        {ctxMenu && (\n          <div\n            style={{\n              position: 'fixed', top: ctxMenu.y, left: ctxMenu.x, background: '#fff',\n              border: '1px solid #e5e7eb', borderRadius: 8, boxShadow: '0 8px 24px rgba(0,0,0,.12)',\n              overflow: 'hidden', zIndex: 60,\n            }}\n            onMouseLeave={ctxClose}\n          >\n            <button className=\"btn secondary\" style={{ borderRadius: 0, width: 180 }} onClick={ctxRename}>Renomear</button>\n            <button className=\"btn secondary\" style={{ borderRadius: 0, width: 180 }} onClick={ctxDuplicate}>Duplicar</button>\n            <button className=\"btn secondary\" style={{ borderRadius: 0, width: 180 }} onClick={ctxReset}>Resetar</button>\n            <button className=\"btn danger\" style={{ borderRadius: 0, width: 180 }} onClick={ctxDelete}>Deletar</button>\n          </div>\n        )}\n\n        {/* Drawer */}\n        <Drawer />\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}